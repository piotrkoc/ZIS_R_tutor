<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Julian Urban">
<meta name="author" content="Piotr Koc">
<meta name="author" content="Zoe Greer">
<meta name="author" content="Franziska Feldmann">

<title>Missing Data in Scale Validation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="missing_data_files/libs/clipboard/clipboard.min.js"></script>
<script src="missing_data_files/libs/quarto-html/quarto.js"></script>
<script src="missing_data_files/libs/quarto-html/popper.min.js"></script>
<script src="missing_data_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="missing_data_files/libs/quarto-html/anchor.min.js"></script>
<link href="missing_data_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="missing_data_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="missing_data_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="missing_data_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="missing_data_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="missing_data_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<script src="missing_data_files/libs/viz-1.8.2/viz.js"></script>

<link href="missing_data_files/libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">

<script src="missing_data_files/libs/grViz-binding-1.0.11/grViz.js"></script>

<script src="missing_data_files/libs/kePrint-0.0.1/kePrint.js"></script>

<link href="missing_data_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">


  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="technical/styles.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#at-a-glance" id="toc-at-a-glance" class="nav-link active" data-scroll-target="#at-a-glance">At a Glance</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a></li>
  <li><a href="#missing-data-mechanisms" id="toc-missing-data-mechanisms" class="nav-link" data-scroll-target="#missing-data-mechanisms">Missing Data Mechanisms</a>
  <ul class="collapse">
  <li><a href="#missing-completely-at-random-mcar" id="toc-missing-completely-at-random-mcar" class="nav-link" data-scroll-target="#missing-completely-at-random-mcar">Missing Completely at Random (MCAR)</a></li>
  <li><a href="#missing-at-random-mar" id="toc-missing-at-random-mar" class="nav-link" data-scroll-target="#missing-at-random-mar">Missing at Random (MAR)</a></li>
  <li><a href="#missing-not-at-random-mnar" id="toc-missing-not-at-random-mnar" class="nav-link" data-scroll-target="#missing-not-at-random-mnar">Missing not at Random (MNAR)</a></li>
  </ul></li>
  <li><a href="#describe-analyse-missing-data-occurrence" id="toc-describe-analyse-missing-data-occurrence" class="nav-link" data-scroll-target="#describe-analyse-missing-data-occurrence">Describe &amp; Analyse Missing Data Occurrence</a>
  <ul class="collapse">
  <li><a href="#describe-missing-data-occurrence" id="toc-describe-missing-data-occurrence" class="nav-link" data-scroll-target="#describe-missing-data-occurrence">Describe Missing Data Occurrence</a></li>
  <li><a href="#analyse-missing-data-occurence" id="toc-analyse-missing-data-occurence" class="nav-link" data-scroll-target="#analyse-missing-data-occurence">Analyse Missing Data Occurence</a></li>
  </ul></li>
  <li><a href="#strategies-of-dealing-with-missing-data" id="toc-strategies-of-dealing-with-missing-data" class="nav-link" data-scroll-target="#strategies-of-dealing-with-missing-data">Strategies of Dealing with Missing Data</a>
  <ul class="collapse">
  <li><a href="#pairwise-deletion" id="toc-pairwise-deletion" class="nav-link" data-scroll-target="#pairwise-deletion">Pairwise Deletion</a></li>
  <li><a href="#listwise-deletion" id="toc-listwise-deletion" class="nav-link" data-scroll-target="#listwise-deletion">Listwise Deletion</a></li>
  <li><a href="#multiple-imputations" id="toc-multiple-imputations" class="nav-link" data-scroll-target="#multiple-imputations">Multiple Imputations</a></li>
  <li><a href="#full-information-maximum-likelihood-fiml" id="toc-full-information-maximum-likelihood-fiml" class="nav-link" data-scroll-target="#full-information-maximum-likelihood-fiml">Full-Information Maximum Likelihood (FIML)</a></li>
  <li><a href="#recap" id="toc-recap" class="nav-link" data-scroll-target="#recap">Recap</a></li>
  </ul></li>
  <li><a href="#simulation-study" id="toc-simulation-study" class="nav-link" data-scroll-target="#simulation-study">Simulation Study</a>
  <ul class="collapse">
  <li><a href="#descriptive-statistics" id="toc-descriptive-statistics" class="nav-link" data-scroll-target="#descriptive-statistics">Descriptive Statistics</a></li>
  <li><a href="#model-fit" id="toc-model-fit" class="nav-link" data-scroll-target="#model-fit">Model Fit</a></li>
  <li><a href="#reliability" id="toc-reliability" class="nav-link" data-scroll-target="#reliability">Reliability</a></li>
  <li><a href="#factor-loadings" id="toc-factor-loadings" class="nav-link" data-scroll-target="#factor-loadings">Factor Loadings</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  <li><a href="#conclusion-and-recommendations" id="toc-conclusion-and-recommendations" class="nav-link" data-scroll-target="#conclusion-and-recommendations">Conclusion and recommendations</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
  <div class="quarto-title">
        <div class="title-container">
      <h1 class="title">Missing Data in Scale Validation</h1>
             <p class="subtitle lead"><em><em>ZIS R-Tutorials</em></em></p>
    </div>
    <div class="logo">
             <img src="pics/zis_logo.svg" height="100">
          </div>
  </div>

  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-heading">Affiliations</div>
        <div class="quarto-title-meta-contents">
      <p class="author">Julian Urban </p>
    </div>
        <div class="quarto-title-meta-contents">
            <p class="affiliation">
        GESIS – Leibniz Institute for the Social Sciences; Trier University
      </p>
          </div>
            <div class="quarto-title-meta-contents">
      <p class="author">Piotr Koc </p>
    </div>
        <div class="quarto-title-meta-contents">
            <p class="affiliation">
        GESIS – Leibniz Institute for the Social Sciences
      </p>
          </div>
            <div class="quarto-title-meta-contents">
      <p class="author">Zoe Greer </p>
    </div>
        <div class="quarto-title-meta-contents">
            <p class="affiliation">
        GESIS – Leibniz Institute for the Social Sciences; Te Herenga Waka – Victoria University of Wellington
      </p>
          </div>
            <div class="quarto-title-meta-contents">
      <p class="author">Franziska Feldmann </p>
    </div>
        <div class="quarto-title-meta-contents">
            <p class="affiliation">
        GESIS – Leibniz Institute for the Social Sciences
      </p>
          </div>
          </div>

  <div class="quarto-title-meta">
        <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">01.01.2025</p>
      </div>
    </div>
         <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date">02.12.2025</p>
      </div>
    </div>
      </div>

   </header>


<section id="at-a-glance" class="level2">
<h2 class="anchored" data-anchor-id="at-a-glance">At a Glance</h2>
<p>What should you pay attention to when you encounter missing item-level data in your scale validation? How can you account for these missing data in your analyses? This tutorial presents important aspects to consider - such as the missing data mechanism - and how to estimate the psychometric properties of your scale in the presence of missing data. Only basic R knowledge is required, and no prior experience with missing data is necessary. Specifically, this tutorial addresses:</p>
<ul>
<li>the different types of missing data mechanisms</li>
<li>how to describe and visualize missing data</li>
<li>various strategies for handling missing data, such as multiple imputation</li>
<li>a small simulation study demonstrating the performance of these strategies in estimating descriptive statistics, model fit, reliabilities, and factor loadings</li>
</ul>
<p>As an example, we use a scale with continuous indicators; therefore, not all parts of the analysis may be appropriate for instruments with categorical indicators.</p>
</section>
<section id="data" class="level2">
<h2 class="anchored" data-anchor-id="data">Data</h2>
<p>In this tutorial, we use the <code>HolzingerSwineford1939</code> <span class="citation" data-cites="rosseel2025">(<a href="#ref-rosseel2025" role="doc-biblioref">Rosseel, Jorgensen, and Wilde 2025</a>)</span> dataset, which includes mental ability test scores from seventh- and eighth-grade students attending two different schools (Pasteur and Grant-White).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan.mi)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggmice)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading the data</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> lavaan<span class="sc">::</span>HolzingerSwineford1939</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a vector with names of scale variables</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>variable_names <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"x"</span>, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>), <span class="at">sep =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The first variable of interest is the presence of missing data. We calculate both the absolute number of missing values per variable and the relative proportion of missing data for each variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Missing values per variable</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(Data[, variable_names]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>x1 x2 x3 x4 x5 x6 x7 x8 x9 
 0  0  0  0  0  0  0  0  0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Percentage of missing values</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(Data[, variable_names])) <span class="sc">/</span> <span class="fu">nrow</span>(Data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>x1 x2 x3 x4 x5 x6 x7 x8 x9 
 0  0  0  0  0  0  0  0  0 </code></pre>
</div>
</div>
<p>The scale variables contain no missing values. We will create missing data under specific missingness mechanisms, which allows us to evaluate the performance of different strategies for handling missing data in our later simulation study. The next section introduces the different missing data mechanisms. In addition, we will repeatedly generate missing data according to each mechanism for the simulation study.</p>
</section>
<section id="missing-data-mechanisms" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="missing-data-mechanisms">Missing Data Mechanisms</h2>
<p>How we handle missing data depends heavily on the underlying missing data mechanism. In general, three mechanisms can be distinguished <span class="citation" data-cites="Rubin.1987">(<a href="#ref-Rubin.1987" role="doc-biblioref">D. B. Rubin 1987</a>)</span>:</p>
<ul>
<li>Missing completely at random (MCAR)</li>
<li>Missing at random (MAR)</li>
<li>Missing not at random (MNAR)</li>
</ul>
<p>We will now take a closer look at these mechanisms and introduce missing values into our dataset according to each one.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>This tutorial focuses on item nonresponse, which means that some data of a participant are missing. In contrast, unit nonresponse means that some persons refsued to participate and hence the sample is not representative. For a more detailed discussion, see <span class="citation" data-cites="vanbuuren2018">Buuren (<a href="#ref-vanbuuren2018" role="doc-biblioref">2018</a>)</span>.</p>
</div></div><section id="missing-completely-at-random-mcar" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="missing-completely-at-random-mcar">Missing Completely at Random (MCAR)</h3>
<p>Data are considered missing completely at random (MCAR) when the probability of missingness on a variable is unrelated to any observed or unobserved data in the dataset <span class="citation" data-cites="Chen.2020 Rubin.1987 vanBuuren.2010">(<a href="#ref-Chen.2020" role="doc-biblioref">Chen, Savalei, and Rhemtulla 2020</a>; <a href="#ref-Rubin.1987" role="doc-biblioref">D. B. Rubin 1987</a>; <a href="#ref-vanBuuren.2010" role="doc-biblioref">van Buuren 2010</a>)</span>. For example, consider an online survey in which a technical issue causes the software to randomly fail to save some responses. As a result, some data are missing, but this missingness is unrelated to the values of the missing variable or to any other variables in the dataset. To display MCAR, we adapted the Figure of <span class="citation" data-cites="Thoemmes.2015">Thoemmes and Mohan (<a href="#ref-Thoemmes.2015" role="doc-biblioref">2015</a>)</span>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="htmlwidget-66e9c577aa09d2544a94" style="width:100%;height:325px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-66e9c577aa09d2544a94">{"x":{"diagram":"\ndigraph flowchart {\n\n  graph [rankdir=TB,\n         ranksep=.3,   \n        nodesep=.3, ]  \n\n  node [width=0.01,height=0.01 shape=box, style=filled, fillcolor=\"#e0e0e0\", color=\"#333\", fontname=\"Arial\", fontsize=4]\n\n  A [label=\"Observed\\nCovariate\"]\n  B [label=\"Scale\\nVariable\"]\n  C [label=\"Unobserved\\nCovariate\"]\n  D [label=\"Missingness\"]\n\n   A -> B [arrowsize=0.5]\n\n  \n{ rank = same; A; C }\n{ rank = same; B; D }\n\n\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>To introduce MCAR into our dataset, we randomly delete data points. Specifically, we randomly determine whether each value for a given variable is missing (0) or observed (1). This missingness process can be modeled using the <code>rbinom()</code> function, which draws random 0/1 values from a binomial distribution with a fixed probability (here, indicating whether each case is set to missing). To more robustly evaluate the effects of MCAR in a small simulation study, we repeat this random deletion process 500 times. We introduce missingness in 15% of the cases for each variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed for reproducibility</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">15101050</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Build a 100 datasets with MCAR</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>Data_list_MCAR <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">500</span>),</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">function</span>(repetition) {</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>                      Data_MCAR <span class="ot">&lt;-</span> Data</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>                      Data_MCAR[, variable_names] <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(variable_names)),</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>                                                            <span class="cf">function</span>(col_index) {</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>                                                              variable <span class="ot">&lt;-</span> Data_MCAR[, variable_names[col_index]]</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>                                                              missings <span class="ot">&lt;-</span> <span class="fu">as.logical</span>(<span class="fu">rbinom</span>(<span class="at">n =</span> <span class="fu">nrow</span>(Data),</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>                                                                                            <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>                                                                                            <span class="at">prob =</span> .<span class="dv">15</span>))</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>                                                              variable[missings] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>                                                              <span class="fu">return</span>(variable)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>                                                              })</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">return</span>(Data_MCAR)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>                      })</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Check whether introducing of missings worked as planned</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">rowMeans</span>(<span class="fu">sapply</span>(Data_list_MCAR,</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>                      <span class="cf">function</span>(data) {</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">colSums</span>(<span class="fu">is.na</span>(data[, variable_names])) <span class="sc">/</span> <span class="fu">nrow</span>(data)</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>                        })),</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   x1    x2    x3    x4    x5    x6    x7    x8    x9 
0.151 0.150 0.150 0.150 0.151 0.150 0.150 0.149 0.150 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># roughly 15% missing data per variable</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>The outer lapply(1:500, …) reruns the MCAR procedure 500 times, returning a list of 500 modified copies of the data. Inside each replicate, sapply(1:length(variable_names), …) loops over the selected columns, uses rbinom() to flag ~15% per column as missing, and simplifies the resulting equal-length vectors into a matrix that’s assigned back to Data_MCAR[, variable_names].</p>
</div></div></section>
<section id="missing-at-random-mar" class="level3">
<h3 class="anchored" data-anchor-id="missing-at-random-mar">Missing at Random (MAR)</h3>
<p>Missingness is considered misssing at random (MAR) when the probability of a value being missing on a variable depends only on observed data but not on the unobserved (i.e., missing) values themselves, after conditioning on the observed values <span class="citation" data-cites="Chen.2020 vanBuuren.2010">(<a href="#ref-Chen.2020" role="doc-biblioref">Chen, Savalei, and Rhemtulla 2020</a>; <a href="#ref-vanBuuren.2010" role="doc-biblioref">van Buuren 2010</a>)</span>. For example, imagine we have collected an online survey about daily screentime with an age diverse sample. Let’s assume that younger participants have a higher screentime than older participants, but younger people are also more likely to not answer our screentime questions. Without conditioning on age, the missing values on screentime would depend on the missing values and would therefore be missing not at random. However, after conditioning on age the missing values on screentime are independent of the missing values and missings are thus missing at random. Again, we display MAR, by adapting the Figure of <span class="citation" data-cites="Thoemmes.2015">Thoemmes and Mohan (<a href="#ref-Thoemmes.2015" role="doc-biblioref">2015</a>)</span>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="htmlwidget-2bf52c70b5a073858bd0" style="width:100%;height:325px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-2bf52c70b5a073858bd0">{"x":{"diagram":"\ndigraph flowchart {\n\n  graph [rankdir=TB,\n         ranksep=.3,   \n        nodesep=.3, ]  \n\n  node [width=0.01,height=0.01 shape=box, style=filled, fillcolor=\"#e0e0e0\", color=\"#333\", fontname=\"Arial\", fontsize=4]\n\n  A [label=\"Observed\\nCovariate\"]\n  B [label=\"Scale\\nVariable\"]\n  C [label=\"Unobserved\\nCovariate\"]\n  D [label=\"Missingness\"]\n\n  A -> B [arrowsize=0.2]\n  A -> D [arrowsize=0.2]\n\n  { rank = same; A; C }\n{ rank = same; B; D }\n  \n    # Invisible edges to enforce 2x2 grid\n  C -> B [style=invis]\n  C -> D [style=invis]\n\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>To introduce MAR into our mental ability school dataset, we first need to define a conditional missingness model. In this case, we condition the probability of missingness on sex and grade, as both variables are associated with the values of our scale variables. In the first step, we specify that the probability of a value being missing depends on a participant’s sex and grade (7th grade or 8th grade). We then determine whether each value is missing (0) or observed (1) using the <code>rbinom()</code> function, applying probabilities based on the defined relationships with sex and grade. To more thoroughly evaluate the effects of MAR, we repeat this missingness process 500 times. As with MCAR, we introduce missingness in 15% of the cases for each variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Define the probability of missingness as a function of sex and grade.</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Compute a linear predictor that determines how likely a value is to be missing  </span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>logit_MAR <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">2.5</span> <span class="sc">*</span> (Data<span class="sc">$</span>sex <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">-</span> <span class="fl">3.5</span> <span class="sc">*</span> (Data<span class="sc">$</span>grade <span class="sc">-</span> <span class="dv">7</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Convert the linear predictor into probabilities between 0 and 1</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co">#    using the inverse logit (logistic) function</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>prob_MAR <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>logit_MAR))</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co"># One value in prob_MAR is missing because grade was missing</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace this missing probability with 0.15</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>prob_MAR[<span class="fu">is.na</span>(prob_MAR)] <span class="ot">&lt;-</span> .<span class="dv">15</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Overview prob_MAR</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>psych<span class="sc">::</span><span class="fu">describe</span>(prob_MAR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   vars   n mean  sd median trimmed  mad min max range skew kurtosis   se
X1    1 301 0.15 0.2   0.08    0.13 0.07   0 0.5   0.5 1.11    -0.68 0.01</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Build a 100 datasets with MCAR</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>Data_list_MAR <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">500</span>),</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">function</span>(repetition) {</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>                      Data_MAR <span class="ot">&lt;-</span> Data</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>                      Data_MAR[, variable_names] <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(variable_names)),</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>                                                           <span class="cf">function</span>(col_index) {</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>                                                             variable <span class="ot">&lt;-</span> Data_MAR[, variable_names[col_index]]</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>                                                             missings <span class="ot">&lt;-</span> <span class="fu">as.logical</span>(<span class="fu">rbinom</span>(<span class="at">n =</span> <span class="fu">nrow</span>(Data),</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>                                                                                           <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>                                                                                           <span class="at">prob =</span> prob_MAR))</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>                                                             variable[missings] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>                                                             <span class="fu">return</span>(variable)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>                                                             })</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">return</span>(Data_MAR)</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>                      })</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Check whether introducing of missings worked as planned</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">rowMeans</span>(<span class="fu">sapply</span>(Data_list_MAR,</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>                      <span class="cf">function</span>(data) {</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">colSums</span>(<span class="fu">is.na</span>(data[, variable_names])) <span class="sc">/</span> <span class="fu">nrow</span>(data)</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>                        })),</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   x1    x2    x3    x4    x5    x6    x7    x8    x9 
0.153 0.153 0.152 0.151 0.151 0.152 0.152 0.151 0.152 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># roughly 15% missing data per variable</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="missing-not-at-random-mnar" class="level3">
<h3 class="anchored" data-anchor-id="missing-not-at-random-mnar">Missing not at Random (MNAR)</h3>
<p>Missingness is considered not at random (MNAR) when the probability of a value being missing depends on the unobserved (i.e., missing) data itself, even after conditioning on the observed values. This definition leaves two scenarios of MNAR <span class="citation" data-cites="Thoemmes.2015">(<a href="#ref-Thoemmes.2015" role="doc-biblioref">Thoemmes and Mohan 2015</a>)</span>. In the first scenario, the missingness depends on the unobserved values of the variable of interest. Returning to our screentime survey example, imagine the survey program has the following issue: it fails to save responses with values greater than 8, even though the response scale ranges from 1 to 10. In this case, the probability of missingness depends directly on the (unobserved) value of the variable of interest. No matter which other variables we condition on, the missingness still relates to the missing value - therefore, the missingness mechanism is not at random. The adpted Figure of <span class="citation" data-cites="Thoemmes.2015">Thoemmes and Mohan (<a href="#ref-Thoemmes.2015" role="doc-biblioref">2015</a>)</span> displays this scenario.</p>
<div class="cell">
<div class="cell-output-display">
<div id="htmlwidget-7c435c35ef81a8b944a4" style="width:100%;height:325px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-7c435c35ef81a8b944a4">{"x":{"diagram":"\ndigraph flowchart {\n\n  graph [rankdir=TB,\n         splines = ortho,\n         ranksep=.3,   \n        nodesep=.3, ]  \n\n  node [width=0.01,height=0.01 shape=box, style=filled, fillcolor=\"#e0e0e0\", color=\"#333\", fontname=\"Arial\", fontsize=4]\n\n  A [label=\"Observed\\nCovariate\"]\n  B [label=\"Scale\\nVariable\"]\n  C [label=\"Unobserved\\nCovariate\"]\n  D [label=\"Missingness\"]\n\n  A -> B [arrowsize=0.2]\n  B -> D [arrowsize=0.2]\n\n  { rank = same; A; C }\n  { rank = same; B; D }\n\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>In the second scenario, missingness depends on the unobserved values of an unobserved covariate. Remember the MAR example, where missingness depended on age. This time, however, age was not included in the survey. Consequently, missingness depends on the unobserved values of an unobserved covariate. The adapted Figure of <span class="citation" data-cites="Thoemmes.2015">Thoemmes and Mohan (<a href="#ref-Thoemmes.2015" role="doc-biblioref">2015</a>)</span> displays this scenario.</p>
<div class="cell">
<div class="cell-output-display">
<div id="htmlwidget-1b798fe70c0ba326c1ba" style="width:100%;height:325px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-1b798fe70c0ba326c1ba">{"x":{"diagram":"\ndigraph flowchart {\n\n  graph [rankdir=TB,\n         ranksep=.3,   \n        nodesep=.3, ]  \n\n  node [width=0.01,height=0.01 shape=box, style=filled, fillcolor=\"#e0e0e0\", color=\"#333\", fontname=\"Arial\", fontsize=4]\n\n  A [label=\"Observed\\nCovariate\"]\n  B [label=\"Scale\\nVariable\"]\n  C [label=\"Unobserved\\nCovariate\"]\n  D [label=\"Missingness\"]\n\n   A -> B [arrowsize=0.5]\n   C -> D [arrowsize=0.5]\n   C -> B [arrowsize=0.5]\n  \n{ rank = same; A; C }\n{ rank = same; B; D }\n  \n  # Invisible edges to enforce 2x2 grid\n  C -> D [style=invis]\n\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>To simulate MNAR in our dataset, we define a condition where missingness is based on the values of the variable itself. Specifically, to introduce approximately 15% missingness, we remove all values above a certain percentile. Initially, we used the 85th percentile, but this led to slightly fewer than 15% missing values, so we adjusted the threshold to the 83.4th percentile. Thus, we introduce missing data by deleting all values above a predefined percentile, which varies normally around 0.834 with a standard deviation (<em>SD</em>) of 0.02.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define probabilities for missingness</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>probs_MNAR <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">500</span>, .<span class="dv">834</span>, .<span class="dv">02</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Introducing missings</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>Data_list_MNAR <span class="ot">&lt;-</span> <span class="fu">lapply</span>(probs_MNAR,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>                          <span class="cf">function</span>(prob) {</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>                            data_temp <span class="ot">&lt;-</span> Data</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>                            data_temp[, variable_names] <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(variable_names)),</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="cf">function</span>(col_index) {</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>                                                                    variable <span class="ot">&lt;-</span> data_temp[, variable_names[col_index]]</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>                                                                    missings <span class="ot">&lt;-</span> variable <span class="sc">&gt;</span> <span class="fu">quantile</span>(variable, <span class="at">probs =</span> prob)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>                                                                    variable[missings] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>                                                                    <span class="fu">return</span>(variable)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>                                                                    })</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">return</span>(data_temp)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>                            })</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Check whether introducing of missings worked as planned</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">rowMeans</span>(<span class="fu">sapply</span>(Data_list_MNAR,</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>                      <span class="cf">function</span>(data) {</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">colSums</span>(<span class="fu">is.na</span>(data[, variable_names])) <span class="sc">/</span> <span class="fu">nrow</span>(data)</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>                        })),</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   x1    x2    x3    x4    x5    x6    x7    x8    x9 
0.151 0.153 0.158 0.141 0.115 0.157 0.162 0.159 0.163 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># roughly 15% missing data per variable</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="describe-analyse-missing-data-occurrence" class="level2">
<h2 class="anchored" data-anchor-id="describe-analyse-missing-data-occurrence">Describe &amp; Analyse Missing Data Occurrence</h2>
<p>In real-world studies, the exact missing data mechanism is usually unknown. Therefore, we must describe and analyze the occurrence of missing data. To this end, we select one dataset for each missing data mechanism (MCAR, MAR, MNAR) to illustrate and compare their effects. Additionally, we create a list containing these datasets by missing data mechanism to facilitate subsequent analyses and computations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># One dataset for MCAR</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>Data_MCAR <span class="ot">&lt;-</span> Data_list_MCAR[[<span class="dv">1</span>]]</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># One dataset for MAR</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>Data_MAR <span class="ot">&lt;-</span> Data_list_MAR[[<span class="dv">1</span>]]</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co"># One dataset for MAR</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>Data_MNAR <span class="ot">&lt;-</span> Data_list_MNAR[[<span class="dv">1</span>]]</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a list containing all datasets</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>list_data <span class="ot">&lt;-</span> <span class="fu">list</span>(Data_MCAR, Data_MAR, Data_MNAR)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(list_data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"MCAR"</span>, <span class="st">"MAR"</span>, <span class="st">"MNAR"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="describe-missing-data-occurrence" class="level3">
<h3 class="anchored" data-anchor-id="describe-missing-data-occurrence">Describe Missing Data Occurrence</h3>
<p>Missing data can be described in several ways. First, we can estimate and visualize the occurrence of missing data for each variable and each case. Next, we can examine the missing data patterns more closely using the <code>ggmice</code> package. We begin by describing and plotting the missing values per variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Describe missing cases per variable</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>missings_per_variable <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">sapply</span>(list_data,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>                                              <span class="cf">function</span>(data) {</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>                                                <span class="fu">colSums</span>(<span class="fu">is.na</span>(data[, variable_names])) <span class="sc">/</span> <span class="fu">nrow</span>(data)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>                                                }))</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(missings_per_variable) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"MCAR"</span>, <span class="st">"MAR"</span>, <span class="st">"MNAR"</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(missings_per_variable, <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    MCAR   MAR  MNAR
x1 0.156 0.173 0.133
x2 0.209 0.159 0.150
x3 0.169 0.146 0.153
x4 0.136 0.150 0.116
x5 0.143 0.136 0.106
x6 0.183 0.150 0.153
x7 0.163 0.140 0.153
x8 0.179 0.153 0.146
x9 0.193 0.183 0.156</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot misings per variable</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>missings_per_variable <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Variable =</span> variable_names) <span class="sc">%&gt;%</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"MCAR"</span>, <span class="st">"MAR"</span>, <span class="st">"MNAR"</span>),</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">values_to =</span> <span class="st">"Percentage missing"</span>,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">names_to =</span> <span class="st">"Mechanism"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Mechanism =</span> <span class="fu">factor</span>(Mechanism, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"MCAR"</span>, <span class="st">"MAR"</span>, <span class="st">"MNAR"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> Variable,</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">y =</span> <span class="st">`</span><span class="at">Percentage missing</span><span class="st">`</span>,</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">fill =</span> Mechanism)) <span class="sc">+</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>,</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">position =</span> <span class="st">"dodge"</span>,</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>                              <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, .<span class="dv">25</span>)) <span class="sc">+</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Percentage Missing Data per Variable"</span>) <span class="sc">+</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">plot.title =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_data_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>As expected, the percentage of missing values varies around 15%, with no major differences between the three missing data mechanisms. This is no surprise given we introduced 15% missing data per variable for each mechanism. Next, we will examine the missing values on a case-by-case basis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Describe missing variable for each case</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>missings_per_case <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">sapply</span>(list_data,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>                                              <span class="cf">function</span>(data) {</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>                                                <span class="fu">rowSums</span>(<span class="fu">is.na</span>(data[, variable_names]))</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>                                                }))</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(missings_per_case) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"MCAR"</span>, <span class="st">"MAR"</span>, <span class="st">"MNAR"</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colMeans</span>(missings_per_case)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    MCAR      MAR     MNAR 
1.531561 1.388704 1.265781 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot misings for each variable</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>missings_per_case <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(missings_per_case))) <span class="sc">%&gt;%</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"MCAR"</span>, <span class="st">"MAR"</span>, <span class="st">"MNAR"</span>),</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">values_to =</span> <span class="st">"Percentage missing"</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">names_to =</span> <span class="st">"Mechanism"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Mechanism =</span> <span class="fu">factor</span>(Mechanism, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"MCAR"</span>, <span class="st">"MAR"</span>, <span class="st">"MNAR"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.factor</span>(<span class="st">`</span><span class="at">Percentage missing</span><span class="st">`</span>),</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">fill =</span> Mechanism)) <span class="sc">+</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>,</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Frequency of Cases"</span>, </span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">x =</span><span class="st">"</span><span class="sc">\n</span><span class="st">Number of Missing Variables"</span>,</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">title =</span> <span class="st">"Number of Missing Variables per Case"</span>) <span class="sc">+</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">plot.title =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_data_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>When examining missingness per case, we observe the first differences between the missing data mechanisms. For MCAR, the number of missing values per case follows a binomial distribution with an expected value of 9 * 0.15 = 1.35. In contrast, the distributions for MAR and MNAR are noticeably skewed. Investigating the occurrence of missing data is important, as it can provide insights into the reasons for missingness and influence how missing data should be handled <span class="citation" data-cites="vanbuuren2018">(<a href="#ref-vanbuuren2018" role="doc-biblioref">Buuren 2018</a>)</span>. To better understand the occurrence of missing data and its consequences, we examine the missing data pattern.</p>
<section id="missing-data-pattern" class="level4">
<h4 class="anchored" data-anchor-id="missing-data-pattern">Missing Data Pattern</h4>
<p>The missing data pattern summarizes missingness both per case and per variable. It shows, for example, how many participants have complete data and whether missingness in one variable is associated with missingness in others. For instance, in longitudinal studies, participants who drop out may have missing data in all subsequent waves. In planned missingness designs, specific groups of participants may have systematically missing blocks of variables. In most cases, however, such clear patterns do not occur. Nevertheless, it is important to identify participants with a large amount of missing data or variables with very few observed values, as these can complicate the imputation process <span class="citation" data-cites="vanbuuren2018">(<a href="#ref-vanbuuren2018" role="doc-biblioref">Buuren 2018</a>)</span>.</p>
<p>To visualize these patterns, we use the <code>plot_pattern()</code> function from the <code>ggmice</code> package <span class="citation" data-cites="oberman2025">(<a href="#ref-oberman2025" role="doc-biblioref">Oberman 2025</a>)</span>. For this example, we focus on the missing data patterns for the test scores (x1, x2, x3).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot missings data pattern</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(list_data,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>       <span class="cf">function</span>(data) {</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>         ggmice<span class="sc">::</span><span class="fu">plot_pattern</span>(data[, <span class="fu">c</span>(<span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>)],</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">square =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>           ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Missing Data Patterns"</span>) <span class="sc">+</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>           ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">plot.title =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>       })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$MCAR</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_data_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
$MAR</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_data_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
$MNAR</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_data_files/figure-html/unnamed-chunk-13-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The missing data patterns align with the plots showing missingness by case and by variable. While the number of cases with no missing variables is higher for MAR and MNAR, there are also more cases with two or three missing variables under these mechanisms. Additionally, the patterns provide an overview of whether missingness in one variable is associated with missingness in others.</p>
</section>
</section>
<section id="analyse-missing-data-occurence" class="level3">
<h3 class="anchored" data-anchor-id="analyse-missing-data-occurence">Analyse Missing Data Occurence</h3>
<p>In real-world data scenarios, the true missing data mechanism (i.e., MCAR, MAR, or MNAR) is typically unknown. However, different missing data mechanisms require different strategies for handling missingness. Generally, we cannot test a particular missing data mechanism. There are only tests that can provide evidence that the MCAR assumption does not hold. That is, if missingness is associated with observed covariates, the data are not MCAR. Importantly, the absence of such associations are no prove for MCAR - missingness may still depend on the unobserved values of the variable itself or on the values of unobserved covariates <span class="citation" data-cites="Raykov.2011">(<a href="#ref-Raykov.2011" role="doc-biblioref">Raykov 2011</a>)</span>. Hence, although examining associations between missingness and other variables can provide useful insights - such as when selecting covariates for multiple imputation - it is rarely advisable to draw conclusions about the underlying missing data mechanism from such tests. Nonetheless, it can be useful to think about the causal relationships underlying the missingness <span class="citation" data-cites="Thoemmes.2015">(<a href="#ref-Thoemmes.2015" role="doc-biblioref">Thoemmes and Mohan 2015</a>)</span>.</p>
</section>
</section>
<section id="strategies-of-dealing-with-missing-data" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="strategies-of-dealing-with-missing-data">Strategies of Dealing with Missing Data</h2>
<p>There are several strategies for handling missing data. In this tutorial, we focus on pairwise deletion, listwise deletion, multiple imputation, and full-information maximum likelihood (FIML). First, we introduce the rationale behind each of these methods. Next, we discuss which strategies are most suitable for different types of analyses and under various missing data mechanisms. Finally, we support this discussion with simulation results comparing the estimation of descriptive statistics, model fit, reliability, and factor loadings across the different missing data mechanisms, using the full sample results as a benchmark.</p>
<section id="pairwise-deletion" class="level3">
<h3 class="anchored" data-anchor-id="pairwise-deletion">Pairwise Deletion</h3>
<p>Pairwise deletion uses all available data to estimate each statistic. For example, means for a variable are calculated using all cases with observed values for that variable, and correlations between two variables are estimated using all cases with observed data on both variables. However, this means that the sample size and composition can vary across different statistics. Moreover, pairwise deletion can result in biased estimates, when missings are not MCAR <span class="citation" data-cites="vanbuuren2018">(<a href="#ref-vanbuuren2018" role="doc-biblioref">Buuren 2018</a>)</span>. Pairwise deletion is typically specified directly in the analysis code.</p>
<section id="prorated-mean-scores" class="level4">
<h4 class="anchored" data-anchor-id="prorated-mean-scores">Prorated Mean Scores</h4>
<p>Prorated means are frequently used to estimate a participant’s scale score when some item responses are missing. For example, if a participant answers 4 out of 5 items on a scale, their scale score is estimated as the mean of those four valid responses. Similar to pairwise deletion, this approach uses all available information. However, calculating a prorated mean score effectively replaces missing item values with the participant’s own average response. This method is appropriate only when item difficulties and selectivities do not vary substantially and the missing data mechanism is MCAR. Otherwise, it may lead to biased individual scale scores, biased group means, and biased (co-)variances <span class="citation" data-cites="mazza2015">(<a href="#ref-mazza2015" role="doc-biblioref">Mazza, Enders, and Ruehlman 2015</a>)</span>. Estimating prorated mean scores is therefore not recommended.</p>
</section>
</section>
<section id="listwise-deletion" class="level3">
<h3 class="anchored" data-anchor-id="listwise-deletion">Listwise Deletion</h3>
<p>Listwise deletion excludes all cases that have missing values on any variable relevant to the analysis. This approach reduces the sample size, which leads to a loss of statistical efficiency. Although it has the advantage that all analyses are conducted on the same set of cases, the loss of information can be tremendous and is only valid under MCAR <span class="citation" data-cites="vanbuuren2018">(<a href="#ref-vanbuuren2018" role="doc-biblioref">Buuren 2018</a>)</span>. If listwise deletion cannot be spcified in the analyses code, it requries the creation of a new dataset where all cases with missing values on any variable of interest are removed.</p>
</section>
<section id="multiple-imputations" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="multiple-imputations">Multiple Imputations</h3>
<p>One frequently used approach for handling missing data is multiple imputation. In this tutorial, we use the <code>mice</code> package <span class="citation" data-cites="vanbuuren2011">(<a href="#ref-vanbuuren2011" role="doc-biblioref">van Buuren and Groothuis-Oudshoorn 2011</a>)</span>, which implements Multivariate Imputation by Chained Equations to replace missing values with plausible estimates.</p>
<p>To apply <code>mice</code>, we first need to define our imputation model.</p>
<p><strong>Step 1: Variable selection.</strong></p>
<p>We must decide which variables to include as predictors in the imputation model, as these variables help to impute the missing values. To avoid biased estimates, at a minimum, all variables used in the analysis model should be included - a principle known as <em>congeniality</em> <span class="citation" data-cites="meng1994">(<a href="#ref-meng1994" role="doc-biblioref">Meng 1994</a>)</span>. It is often beneficial to include additional variables beyond the analysis model, particularly those that are highly correlated with the variables to be imputed or with the missingness itself. In our MAR example, missingness correlates with <code>sex</code>, which might not be part of the analysis model. Omitting <code>sex</code> from the imputation model could result in data that are still missing not at random. Including variables that are associated with missingness is important to avoid biased estimates, while including variables that are highly correlated with those to be imputed can increase precision. However, including variables that themselves have a large amount of missing data, or including many variables when the sample size is small, may lead to biased estimates <span class="citation" data-cites="axenfeld2022 Murray.2018 vanbuuren2018">(<a href="#ref-axenfeld2022" role="doc-biblioref">Axenfeld, Bruch, and Wolf 2022</a>; <a href="#ref-Murray.2018" role="doc-biblioref">Murray 2018</a>; <a href="#ref-vanbuuren2018" role="doc-biblioref">Buuren 2018</a>)</span>.</p>
<p><strong>Step 2: Choosing the imputation method.</strong></p>
<p>The <code>mice</code> package offers various imputation methods suitable for different data types. For numeric variables, <code>mice</code> uses <code>norm</code> (Bayesian linear regression) as default; for binary variables, <code>mice</code> uses <code>logreg</code> (Bayesian logistic regression) as default. A widely used method method, which is recommended especially for metric variables<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>, is <code>pmm</code> (predictive mean matching) <span class="citation" data-cites="rubin1986 little1986">(<a href="#ref-rubin1986" role="doc-biblioref">Donald B. Rubin 1986</a>; <a href="#ref-little1986" role="doc-biblioref">Little 1986</a>)</span>. In <code>pmm</code>, missing values are imputed by borrowing observed values from “donor” cases with similar observed data, preserving realistic data distributions.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>According to <span class="citation" data-cites="vanbuuren2018">Buuren (<a href="#ref-vanbuuren2018" role="doc-biblioref">2018</a>)</span>, using Bayesian regression for imputations is preferable to standard regression. Unlike standard regression, Bayesian regression draws from the posterior distribution to obtain predicted values. Consequently, the predicted (i.e., imputed) values reflect the uncertainty inherent in the imputation process. Standard regression, which produces a single deterministic predicted value, does not account for this uncertainty and is therefore not recommended.</p>
</div></div><p><strong>Step 3: Setting the number of iterations.</strong></p>
<p>Multiple imputation via chained equations is an iterative process where each iteration refines the estimates using the most recent imputations. More iterations improve the stability of the imputation model and help achieve convergence. Typically, 5 to 20 iterations are sufficient to reach convergence <span class="citation" data-cites="vanbuuren2018">(<a href="#ref-vanbuuren2018" role="doc-biblioref">Buuren 2018</a>)</span>. However, for some cases the number of iterations need to be substantially higher to achieve convergence <span class="citation" data-cites="vanbuuren2018">(<a href="#ref-vanbuuren2018" role="doc-biblioref">Buuren 2018</a>)</span>. As discussed later, we can evaluate whether the imputations converged. One way to deal with convergence issues is to increase the number of iterations.</p>
<p><strong>Step 4: Deciding on the number of imputed datasets.</strong></p>
<p>Because imputation involves randomness, creating multiple imputed datasets allows pooling of results to reduce variance. More imputed datasets improve the precision of estimates but increase computation time. <span class="citation" data-cites="vanbuuren2018">Buuren (<a href="#ref-vanbuuren2018" role="doc-biblioref">2018</a>)</span> argues that 5 to 20 imputed datasets are usually sufficient, especially when point estimates are of interest. Aligning with this recommendation, <span class="citation" data-cites="White.2011">White, Royston, and Wood (<a href="#ref-White.2011" role="doc-biblioref">2011</a>)</span> suggest using at least as many imputations as the percentage of missing data (e.g., 15 imputations for 15% missing data).</p>
<p><strong>Step 5: Analyze data &amp; pool results.</strong></p>
<p>Once the data have been imputed, they can be analyzed. The first step is to perform the planned analyses separately in each imputed dataset. For descriptive statistics, this may involve estimating the mean (i.e., the intercept) of a variable within each dataset (noted as <span class="math inline">\hat{\theta_i}</span>, with theta indicating the mean and <em>i</em> the imputed data set). The second step is to combine, or pool, these estimates using, for example, Rubin’s Rule <span class="citation" data-cites="Rubin.1987">(<a href="#ref-Rubin.1987" role="doc-biblioref">D. B. Rubin 1987</a>)</span>. According to Rubin’s Rule, the pooled estimate (noted as <span class="math inline">\bar{\theta}</span>) is the arithmetic mean of the estimates obtained from the individual imputed datasets (with m indicating the number of imputed data sets). For descriptive statistics, this corresponds to calculating the mean across the estimated means from all imputed datasets <span class="citation" data-cites="enders2022">(<a href="#ref-enders2022" role="doc-biblioref">Enders 2022</a>)</span>.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Using the arithmetic mean of the estimates to pool according to Rubin’s Rule <span class="citation" data-cites="Rubin.1987">(<a href="#ref-Rubin.1987" role="doc-biblioref">D. B. Rubin 1987</a>)</span> is only valid for approximately normally distributed quantities, such as means or regression coefficients. To pool other quantities, such as correlation coefficients, requires a transformation (e.g., Fisher’s z transformation) before pooling <span class="citation" data-cites="vonbuuren2018">(<a href="#ref-vonbuuren2018" role="doc-biblioref"><strong>vonbuuren2018?</strong></a>)</span>.</p>
</div></div><p><span class="math display"> \bar{\theta} = \frac{1}{m} \sum_{i=1}^{m} \hat{\theta_i} </span></p>
<p>The variance (i.e., the squared standard error) of the pooled estimate can also be computed. It consists of two components: (1) the within-imputation variance, which represents the average variance estimate across the imputed datasets, and (2) the between-imputation variance, which reflects the variability of the estimates across the imputed datasets and thus captures the uncertainty introduced by imputation <span class="citation" data-cites="enders2022">(<a href="#ref-enders2022" role="doc-biblioref">Enders 2022</a>)</span>. The within-imputation variance can be estimated using the following formula <span class="citation" data-cites="enders2022">(<a href="#ref-enders2022" role="doc-biblioref">Enders 2022</a>)</span><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>:</p>
<p><span class="math display"> V_W = \frac{1}{m} \sum_{i=1}^{m}\hat{SE_i^2} </span></p>
<p>The between-imputation variance can be estimated using the following formula <span class="citation" data-cites="enders2022">(<a href="#ref-enders2022" role="doc-biblioref">Enders 2022</a>)</span>:</p>
<p><span class="math display"> V_B = \frac{1}{m - 1} \sum_{i=1}^{m}( \hat{\theta_i} - \bar{\theta})^2 </span></p>
<p>The total variance is then obtained by summing the within-imputation variance and (1 + 1/number of imputations) times the between-imputation variance <span class="citation" data-cites="Rubin.1987 enders2022">(<a href="#ref-Rubin.1987" role="doc-biblioref">D. B. Rubin 1987</a>; <a href="#ref-enders2022" role="doc-biblioref">Enders 2022</a>)</span>:</p>
<p><span class="math display"> V_t = V_W + V_B + \frac{V_B}{m} </span></p>
<p>The square-root of the total variance is then the pooled standard error <span class="citation" data-cites="enders2022">(<a href="#ref-enders2022" role="doc-biblioref">Enders 2022</a>)</span>.</p>
<p><span class="math display"> SE = \sqrt{V_t} </span></p>
<p><strong>Illustrative Example</strong></p>
<p>For our example, we impute missing values in the scale variables, including <code>sex</code> and <code>grade</code> as predictors since missingness may depend on them. We use <code>pmm</code> to generate 15 imputed datasets with 10 iterations for the MAR scenario. After imputation, we check whether the model has converged using taceplots and stripplots.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Conducting multiple imputations</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>multiple_imputations_MAR <span class="ot">&lt;-</span> mice<span class="sc">::</span><span class="fu">mice</span>(Data_MAR,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">m =</span> <span class="dv">15</span>,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">method =</span> <span class="st">"pmm"</span>, </span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">maxit =</span> <span class="dv">10</span>,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">printFlag =</span> <span class="cn">FALSE</span>)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Check convergence of models for 3 example variables</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(multiple_imputations_MAR,</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>     <span class="fu">c</span>(<span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>),</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Traceplots"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_data_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Traces intermix and no trends at late iterations are visible</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Write function to create stripplots for variables x1, x2, and x3</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>stripplots_x1 <span class="ot">&lt;-</span> <span class="cf">function</span>(imp) {</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lapply</span>(<span class="fu">c</span>(<span class="st">"x1"</span>),</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>         <span class="cf">function</span>(variable) {</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>           mice<span class="sc">::</span><span class="fu">stripplot</span>(imp,</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">as.formula</span>(<span class="fu">paste</span>(variable, <span class="st">" ~ .imp"</span>, <span class="at">sep =</span> <span class="st">""</span>)),</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>                           <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>                           <span class="at">cex =</span> <span class="dv">2</span>,</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>                           <span class="at">main =</span> <span class="st">"Stripplot"</span>)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>           })</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Stripplots</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="fu">stripplots_x1</span>(multiple_imputations_MAR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_data_files/figure-html/unnamed-chunk-14-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Imputed values (red) intermix with observed values (blue)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The trace plots intermix and no trend is visible in the later iterations. This intermix and the absence of a trend indicate convergence, which means that the number of iterations was sufficient. A trend at late iterations would have indicated that the estimate has not yet converged.</p>
<p>The stripplots show that the imputed values (in red) intermingle with the observed values (in blue). If the imputed and observed values do not intermingle, this can either indicate the absence of MCAR or a bad imputation model <span class="citation" data-cites="vanbuuren2018">(<a href="#ref-vanbuuren2018" role="doc-biblioref">Buuren 2018</a>)</span>.</p>
<p>As the model has converged, we can now estimate pooled statistics. First, we estimate the pooled mean by fitting a linear model with only an intercept (i.e., no predictors) in each imputed dataset. In such a model, the intercept corresponds to the sample mean of the outcome variable. We then pool these intercept estimates across imputations. Next, we fit a CFA model using <code>lavaan.mi</code> to examine both model fit, the resulting reliability, and the factor loadings. Additionally, we compare the pooled statistics to those of the full sample.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate pooled mean of x1</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>multiple_imputation_means_MAR <span class="ot">&lt;-</span> <span class="fu">with</span>(multiple_imputations_MAR,</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">lm</span>(x1 <span class="sc">~</span> <span class="dv">1</span>))</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>multiple_imputation_pooled_mean_MAR <span class="ot">&lt;-</span> <span class="fu">summary</span>(mice<span class="sc">::</span><span class="fu">pool</span>(multiple_imputation_means_MAR))</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare pooled mean to true mean</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>multiple_imputation_pooled_mean_MAR[, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  estimate  std.error
1 4.914323 0.07794708</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(Data<span class="sc">$</span>x1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.93577</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(Data<span class="sc">$</span>x1) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">nrow</span>(Data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.06728967</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate CFA scross imputed datasets</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Define factor model</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>three_fator_model <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="st">visual =~ x1 + x2 + x3</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="st">textual =~ x4 + x5 + x6</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="st">speed =~ x7 + x8 + x9</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate CFAs</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="co"># multiple imputations</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>cfa_multiple_imputations_MAR <span class="ot">&lt;-</span> lavaan.mi<span class="sc">::</span><span class="fu">cfa.mi</span>(<span class="at">model =</span> three_fator_model,</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">data =</span> multiple_imputations_MAR,</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">estimator =</span> <span class="st">"ml"</span>,</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">std.lv =</span> <span class="cn">TRUE</span>)</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Full sample</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>cfa_full_data <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">cfa</span>(<span class="at">model =</span> three_fator_model,</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>                             <span class="at">data =</span> Data,</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>                             <span class="at">estimator =</span> <span class="st">'ml'</span>,</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>                             <span class="at">std.lv =</span> <span class="cn">TRUE</span>)</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare model fit</span></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>fit_measures <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"chisq.scaled"</span>, <span class="st">"df"</span>, <span class="st">"pvalue.scaled"</span>,</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"cfi.robust"</span>, <span class="st">"rmsea.robust"</span>, <span class="st">"srmr"</span>)</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>lavaan<span class="sc">::</span><span class="fu">fitmeasures</span>(cfa_full_data, </span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>                    <span class="at">fit.measures =</span> fit_measures)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    df   srmr 
24.000  0.065 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>lavaan<span class="sc">::</span><span class="fu">fitmeasures</span>(cfa_multiple_imputations_MAR, </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">fit.measures =</span> fit_measures)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Test statistic(s) pooled using the D4 pooling method.
  Pooled statistic: "standard"

    df   srmr 
24.000  0.072 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare reliability</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>semTools<span class="sc">::</span><span class="fu">compRelSEM</span>(cfa_full_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> visual textual   speed 
  0.612   0.885   0.686 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>semTools<span class="sc">::</span><span class="fu">compRelSEM</span>(cfa_multiple_imputations_MAR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> visual textual   speed 
  0.633   0.883   0.649 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare factor loadings</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>loadings_full <span class="ot">&lt;-</span> <span class="fu">unlist</span>(lavaan<span class="sc">::</span><span class="fu">lavInspect</span>(cfa_full_data, <span class="st">"est"</span>)<span class="sc">$</span>lambda)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>loadings_full[loadings_full <span class="sc">!=</span> <span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8996203 0.4979405 0.6561561 0.9896934 1.1016047 0.9166010 0.6194754
[8] 0.7309488 0.6699801</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>lavaan.mi<span class="sc">::</span><span class="fu">parameterEstimates.mi</span>(cfa_multiple_imputations_MAR)<span class="sc">$</span>est[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9020795 0.5219877 0.6679742 1.0159827 1.1052736 0.9131955 0.5731974
[8] 0.6803091 0.7141344</code></pre>
</div>
</div>
<p>The displayed results show, that the results estimated with multiple imputations closely reassembles those of the full sample. We will discuss this more thoroughly later in the simulation study.</p>
</section>
<section id="full-information-maximum-likelihood-fiml" class="level3">
<h3 class="anchored" data-anchor-id="full-information-maximum-likelihood-fiml">Full-Information Maximum Likelihood (FIML)</h3>
<p>A popular way to handle missing data in factor models, such as confirmatory factor analysis (CFA), is Full Information Maximum Likelihood (<em>FIML</em>). The basic idea of maximum likelihood is to estimate how likely the observed data are, given certain assumptions about the population. For example, if the population IQ has a mean of 100 and variance of 225, how likely is it to observe a score of 95? This probability is called the likelihood, and we usually work with its logarithm (log-likelihood) for convenience. Statistical methods based on maximum likelihood then find the parameter values that maximize the likelihood of the observed data - that is, the values under which the observed data are most probable.</p>
<p>When we have multiple variables, maximum likelihood considers the combination of all observed scores, taking into account their means, variances, and how the variables relate to each other (covariances). For instance, we can estimate how likely it is to see an IQ of 95 and a well-being score of 65, given the population averages and the correlation between IQ and well-being.</p>
<p>Missing data complicate this calculation. Simply leaving out cases with missing values can distort the estimates for all variables, not just the ones with missing data. This can lead to biased results, especially if the missingness depends on observed data (MAR).</p>
<p>FIML solves this by using all the available information. It calculates likelihoods for different subgroups of participants based on their missing data patterns (e.g., people with complete data, people missing an IQ score, people missing a well-being score). Then, it combines these subgroup likelihoods to estimate the overall model parameters. In addition, FIML adjusts the standard errors of the estimates according to how much information is available for each parameter, giving more accurate results than simply ignoring missing data..</p>
<p>One advantage of FIML is that dealing with missing values is integrated into the analysis process. The disadvantage of FIML is that it is only applicable in combination with methods using maximum likelihood.</p>
<p>In the code below, we demonstrate how FIML is specified in a CFA.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate CFA using FIML</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>cfa_FIML_MAR <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">cfa</span>(<span class="at">model =</span> three_fator_model,</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">data =</span> Data_MAR,</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">estimator =</span> <span class="st">'ml'</span>,</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>                            <span class="at">std.lv =</span> <span class="cn">TRUE</span>,</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>                            <span class="at">missing =</span> <span class="st">"FIML"</span>)</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare model fit</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>lavaan<span class="sc">::</span><span class="fu">fitmeasures</span>(cfa_full_data, </span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">fit.measures =</span> fit_measures)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    df   srmr 
24.000  0.065 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>lavaan<span class="sc">::</span><span class="fu">fitmeasures</span>(cfa_FIML_MAR, </span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">fit.measures =</span> fit_measures)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          df   cfi.robust rmsea.robust         srmr 
      24.000        0.932        0.092        0.060 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare reliability</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>semTools<span class="sc">::</span><span class="fu">compRelSEM</span>(cfa_full_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> visual textual   speed 
  0.612   0.885   0.686 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>semTools<span class="sc">::</span><span class="fu">compRelSEM</span>(cfa_FIML_MAR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> visual textual   speed 
  0.636   0.882   0.685 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare factor loadings</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>lavaan<span class="sc">::</span><span class="fu">lavInspect</span>(cfa_full_data, <span class="st">"est"</span>)<span class="sc">$</span>lambda</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   visual textul speed
x1  0.900  0.000 0.000
x2  0.498  0.000 0.000
x3  0.656  0.000 0.000
x4  0.000  0.990 0.000
x5  0.000  1.102 0.000
x6  0.000  0.917 0.000
x7  0.000  0.000 0.619
x8  0.000  0.000 0.731
x9  0.000  0.000 0.670</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>lavaan<span class="sc">::</span><span class="fu">lavInspect</span>(cfa_FIML_MAR, <span class="st">"est"</span>)<span class="sc">$</span>lambda</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   visual textul speed
x1  0.898  0.000 0.000
x2  0.519  0.000 0.000
x3  0.667  0.000 0.000
x4  0.000  1.015 0.000
x5  0.000  1.088 0.000
x6  0.000  0.912 0.000
x7  0.000  0.000 0.619
x8  0.000  0.000 0.733
x9  0.000  0.000 0.684</code></pre>
</div>
</div>
<p>The results show that the estimates obtained using FIML under MAR closely resemble those from the full sample.</p>
</section>
<section id="recap" class="level3">
<h3 class="anchored" data-anchor-id="recap">Recap</h3>
<p>In this section we introduced different ways of dealing with missing data. We introduced rather simple strategies such as pairwise or listwise deletion, but also more complex strategies such as multiple imputations and FIML. For these more complex strategies, we demonstrated their application under the MAR assumption and showed that the results closely resemble those of the full sample. The next section builds on this by presenting a small simulation study that compares different strategies across various missing data mechanisms.</p>
</section>
</section>
<section id="simulation-study" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="simulation-study">Simulation Study</h2>
<p>This section introduces a small Monte-Carlo simulation study. Simulation studies are empirical experiments used to investigate the performance of statistical methods under controlled conditions <span class="citation" data-cites="morris.2019">(<a href="#ref-morris.2019" role="doc-biblioref">Morris, White, and Crowther 2019</a>)</span>. They rely on pseudo-random sampling from a specified population model to evaluate how well sample-based estimates recover known population parameters. In essence, simulation studies allow researchers to assess how statistical procedures behave across many hypothetical replications of an experiment, each generated from the same underlying population <span class="citation" data-cites="morris.2019">(<a href="#ref-morris.2019" role="doc-biblioref">Morris, White, and Crowther 2019</a>)</span>.</p>
<p>In this simulation study, we generated 500 samples for each missing data mechanism. For each sample, we estimated item means, model fit indices, reliability, and factor loadings. We then evaluated how closely these estimates resembled the corresponding statistics from the full sample, which served as the population reference. We also compared different strategies for handling missing data and assessed their performance under the different missing data mechanisms.</p>
<p>To evaluate the performance of these strategies, we focused on two commonly used performance measures: (Monte-Carlo) bias and standard error <span class="citation" data-cites="morris.2019">(<a href="#ref-morris.2019" role="doc-biblioref">Morris, White, and Crowther 2019</a>)</span>. Bias quantifies how much the mean of the sample-based estimates deviates from the true population parameter. If the mean of the sample estimates equals the population value, the estimator is unbiased. If the mean of the sample estimates deviates from the population value, the estimator is biased. Standard error reflects the variability of the sample estimates around their mean. A smaller standard error indicates that estimates from different samples are more tightly clustered around the average estimate, implying greater statistical efficiency or precision <span class="citation" data-cites="morris.2019">(<a href="#ref-morris.2019" role="doc-biblioref">Morris, White, and Crowther 2019</a>)</span>.</p>
<p>The figure below illustrates these concepts by showing potential distributions of sample estimates. The first row represents unbiased estimation, where the dashed line (mean of the sample estimates) aligns with the solid line (population value). The second row shows biased estimation, where the dashed line deviates from the solid line. The first column displays estimates with a low standard error (narrower distribution), whereas the second column represents estimates with a high standard error (wider distribution).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>), <span class="at">font.main =</span> <span class="dv">2</span>)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define standard deviations</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>sd_low <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>sd_high <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> sd_low  <span class="co"># 2x the low SE</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Define common axis limits for all plots</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>x_range <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="dv">6</span>)</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>y_max <span class="ot">&lt;-</span> <span class="fl">9e2</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of samples for histogram</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> <span class="fl">5e3</span></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Define uniform breaks for all histograms (extend well beyond x_range to catch all values)</span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>breaks <span class="ot">&lt;-</span> <span class="fu">seq</span>(x_range[<span class="dv">1</span>] <span class="sc">-</span> <span class="dv">2</span>, x_range[<span class="dv">2</span>] <span class="sc">+</span> <span class="dv">2</span>, <span class="at">by =</span> <span class="fl">0.4</span>)</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate ONE base sample from standard normal</span></span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>base_sample <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_samples, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform the base sample for each plot</span></span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a>samples1 <span class="ot">&lt;-</span> base_sample <span class="sc">*</span> sd_low <span class="sc">+</span> <span class="dv">0</span>  <span class="co"># Low SE, No Bias</span></span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a>samples2 <span class="ot">&lt;-</span> base_sample <span class="sc">*</span> sd_high <span class="sc">+</span> <span class="dv">0</span>  <span class="co"># High SE, No Bias</span></span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a>samples3 <span class="ot">&lt;-</span> base_sample <span class="sc">*</span> sd_low <span class="sc">+</span> <span class="dv">1</span>  <span class="co"># Low SE, Bias</span></span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a>samples4 <span class="ot">&lt;-</span> base_sample <span class="sc">*</span> sd_high <span class="sc">+</span> <span class="dv">1</span>  <span class="co"># High SE, Bias</span></span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine the range of all data</span></span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a>all_data <span class="ot">&lt;-</span> <span class="fu">c</span>(samples1, samples2, samples3, samples4)</span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a>data_range <span class="ot">&lt;-</span> <span class="fu">range</span>(all_data)</span>
<span id="cb62-32"><a href="#cb62-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-33"><a href="#cb62-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Create breaks that span from well before the minimum to well after the maximum</span></span>
<span id="cb62-34"><a href="#cb62-34" aria-hidden="true" tabindex="-1"></a>breaks <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">floor</span>(<span class="fu">min</span>(data_range, x_range[<span class="dv">1</span>]) <span class="sc">-</span> <span class="dv">2</span>), </span>
<span id="cb62-35"><a href="#cb62-35" aria-hidden="true" tabindex="-1"></a>              <span class="fu">ceiling</span>(<span class="fu">max</span>(data_range, x_range[<span class="dv">2</span>]) <span class="sc">+</span> <span class="dv">2</span>), </span>
<span id="cb62-36"><a href="#cb62-36" aria-hidden="true" tabindex="-1"></a>              <span class="at">by =</span> <span class="fl">0.4</span>)</span>
<span id="cb62-37"><a href="#cb62-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-38"><a href="#cb62-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to plot a histogram with vertical lines</span></span>
<span id="cb62-39"><a href="#cb62-39" aria-hidden="true" tabindex="-1"></a>plot_histogram <span class="ot">&lt;-</span> <span class="cf">function</span>(samples, mean_val, true_val, title, <span class="at">show_labels =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb62-40"><a href="#cb62-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create histogram</span></span>
<span id="cb62-41"><a href="#cb62-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(samples, <span class="at">breaks =</span> breaks, <span class="at">xlim =</span> x_range, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, y_max),</span>
<span id="cb62-42"><a href="#cb62-42" aria-hidden="true" tabindex="-1"></a>       <span class="at">axes =</span> <span class="cn">FALSE</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">main =</span> title,</span>
<span id="cb62-43"><a href="#cb62-43" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"gray80"</span>, <span class="at">border =</span> <span class="st">"black"</span>)</span>
<span id="cb62-44"><a href="#cb62-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-45"><a href="#cb62-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add vertical lines</span></span>
<span id="cb62-46"><a href="#cb62-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v =</span> true_val, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">1</span>)  <span class="co"># solid line for theta</span></span>
<span id="cb62-47"><a href="#cb62-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v =</span> mean_val, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">3</span>)  <span class="co"># dotted line for theta-bar</span></span>
<span id="cb62-48"><a href="#cb62-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-49"><a href="#cb62-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add labels under the lines (outside plot area)</span></span>
<span id="cb62-50"><a href="#cb62-50" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (show_labels) {</span>
<span id="cb62-51"><a href="#cb62-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mtext</span>(<span class="fu">expression</span>(<span class="fu">bold</span>(theta)), <span class="at">side =</span> <span class="dv">1</span>, <span class="at">line =</span> <span class="dv">1</span>, <span class="at">at =</span> true_val, <span class="at">font =</span> <span class="dv">2</span>)</span>
<span id="cb62-52"><a href="#cb62-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mtext</span>(<span class="fu">expression</span>(<span class="fu">bold</span>(<span class="fu">bar</span>(theta))), <span class="at">side =</span> <span class="dv">1</span>, <span class="at">line =</span> <span class="dv">1</span>, <span class="at">at =</span> mean_val, <span class="at">font =</span> <span class="dv">2</span>)</span>
<span id="cb62-53"><a href="#cb62-53" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb62-54"><a href="#cb62-54" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-55"><a href="#cb62-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-56"><a href="#cb62-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Top left: Low Standard Error, No Bias</span></span>
<span id="cb62-57"><a href="#cb62-57" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_histogram</span>(<span class="at">mean_val =</span> <span class="dv">0</span>, <span class="at">samples =</span> samples1, <span class="at">true_val =</span> <span class="dv">0</span>, </span>
<span id="cb62-58"><a href="#cb62-58" aria-hidden="true" tabindex="-1"></a>               <span class="at">title =</span> <span class="st">"Low Standard Error</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">show_labels =</span> <span class="cn">TRUE</span>)</span>
<span id="cb62-59"><a href="#cb62-59" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">"No Bias"</span>, <span class="at">side =</span> <span class="dv">2</span>, <span class="at">line =</span> <span class="fl">2.5</span>, <span class="at">las =</span> <span class="dv">3</span>, <span class="at">font =</span> <span class="dv">2</span>)</span>
<span id="cb62-60"><a href="#cb62-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-61"><a href="#cb62-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Top right: High Standard Error, No Bias</span></span>
<span id="cb62-62"><a href="#cb62-62" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_histogram</span>(<span class="at">mean_val =</span> <span class="dv">0</span>, <span class="at">samples =</span> samples2, <span class="at">true_val =</span> <span class="dv">0</span>, </span>
<span id="cb62-63"><a href="#cb62-63" aria-hidden="true" tabindex="-1"></a>               <span class="at">title =</span> <span class="st">"High Standard Error</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">show_labels =</span> <span class="cn">TRUE</span>)</span>
<span id="cb62-64"><a href="#cb62-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-65"><a href="#cb62-65" aria-hidden="true" tabindex="-1"></a><span class="co"># Bottom left: Low Standard Error</span></span>
<span id="cb62-66"><a href="#cb62-66" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_histogram</span>(<span class="at">mean_val =</span> <span class="dv">1</span>, <span class="at">samples =</span> samples3, <span class="at">true_val =</span> <span class="dv">0</span>, </span>
<span id="cb62-67"><a href="#cb62-67" aria-hidden="true" tabindex="-1"></a>               <span class="at">title =</span> <span class="st">""</span>, <span class="at">show_labels =</span> <span class="cn">TRUE</span>)</span>
<span id="cb62-68"><a href="#cb62-68" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">"Bias"</span>, <span class="at">side =</span> <span class="dv">2</span>, <span class="at">line =</span> <span class="fl">2.5</span>, <span class="at">las =</span> <span class="dv">3</span>, <span class="at">font =</span> <span class="dv">2</span>)</span>
<span id="cb62-69"><a href="#cb62-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-70"><a href="#cb62-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Bottom right: High Standard Error</span></span>
<span id="cb62-71"><a href="#cb62-71" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_histogram</span>(<span class="at">mean_val =</span> <span class="dv">1</span> , <span class="at">samples =</span> samples4, <span class="at">true_val =</span> <span class="dv">0</span>, </span>
<span id="cb62-72"><a href="#cb62-72" aria-hidden="true" tabindex="-1"></a>               <span class="at">title =</span> <span class="st">""</span>, <span class="at">show_labels =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_data_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We present the results for bias using boxplots. In our simulation study, the boxplots indicate the quartiles (i.e., 25th percentile, median, 75th percentile) of the sample-based estimates. If the median is close to zero, the deviation from the population value is small - indicating that the statistic is unbiased. Contrary, a deviation of the median from zero would indicate bias.</p>
<p>We present the results for the standard error by presenting tables. These tables show the standard error for the respective strategy under a specific missing data mechanism. Smaller standard error indicate a higher precision of the sample-based estimates. Additionally, we present the standard error of the statistic estimated using the full sample without missing data (<code>Data</code>). As the full sample can rely on more information - as it has no missing data - we expect the standard errors of the sample-based estimates to be slightly higher than the standard errors of the full sample.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Built list with data</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>list_simulation <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">MCAR =</span> Data_list_MCAR,</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">MAR =</span> Data_list_MAR,</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">MNAR =</span> Data_list_MNAR)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Write function to plot or table simulation results</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>plot_bias <span class="ot">&lt;-</span> <span class="cf">function</span>(results,</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>                      true,</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>                      title,</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>                      levels) {</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>  number_strategies <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(results<span class="sc">$</span>strategy))</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  results<span class="sc">$</span>order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>), <span class="at">times =</span> number_strategies))</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>  results<span class="sc">$</span>strategy <span class="ot">&lt;-</span> <span class="fu">factor</span>(results<span class="sc">$</span>strategy, <span class="at">levels =</span> levels)</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>  outcome <span class="ot">&lt;-</span> <span class="fu">colnames</span>(results)[<span class="dv">1</span>]</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>  results<span class="sc">$</span>bias <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(results[[outcome]]) <span class="sc">-</span> true</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>   plot <span class="ot">&lt;-</span>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">data =</span> results,</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>                            ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(mechanism, order), </span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">y =</span> bias,</span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">fill =</span> strategy)) <span class="sc">+</span></span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>     ggplot2<span class="sc">::</span><span class="fu">geom_boxplot</span>(<span class="at">position =</span> ggplot2<span class="sc">::</span><span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>     ggplot2<span class="sc">::</span><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>     ggplot2<span class="sc">::</span><span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>     ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Missing Data Mechanism"</span>,</span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="st">"Bias"</span>,</span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fill =</span> <span class="st">"Strategy"</span>,</span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a>                   <span class="at">caption =</span> <span class="st">"The boxplots display the bias for the different strategies under different missing data mechanisms.</span><span class="sc">\n</span><span class="st">The black line within each boxplot indicates the median bias."</span>,</span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a>                   <span class="at">title =</span> title) <span class="sc">+</span></span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>     ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">plot.title =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a>                    <span class="at">plot.caption =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>))</span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a>   <span class="fu">return</span>(plot)</span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-34"><a href="#cb63-34" aria-hidden="true" tabindex="-1"></a>table_se <span class="ot">&lt;-</span> <span class="cf">function</span>(results,</span>
<span id="cb63-35"><a href="#cb63-35" aria-hidden="true" tabindex="-1"></a>                     true_se,</span>
<span id="cb63-36"><a href="#cb63-36" aria-hidden="true" tabindex="-1"></a>                     <span class="at">between_only =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb63-37"><a href="#cb63-37" aria-hidden="true" tabindex="-1"></a>  pooled_ses <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">sapply</span>(<span class="fu">unique</span>(results<span class="sc">$</span>mechanism),</span>
<span id="cb63-38"><a href="#cb63-38" aria-hidden="true" tabindex="-1"></a>                       <span class="cf">function</span>(mechanism) {</span>
<span id="cb63-39"><a href="#cb63-39" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">sapply</span>(<span class="fu">unique</span>(results<span class="sc">$</span>strategy),</span>
<span id="cb63-40"><a href="#cb63-40" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">function</span>(strategy) {</span>
<span id="cb63-41"><a href="#cb63-41" aria-hidden="true" tabindex="-1"></a>                                  </span>
<span id="cb63-42"><a href="#cb63-42" aria-hidden="true" tabindex="-1"></a>                                  df_temp <span class="ot">&lt;-</span> results[results<span class="sc">$</span>mechanism <span class="sc">==</span> mechanism <span class="sc">&amp;</span></span>
<span id="cb63-43"><a href="#cb63-43" aria-hidden="true" tabindex="-1"></a>                                                       results<span class="sc">$</span>strategy <span class="sc">==</span> strategy, ]</span>
<span id="cb63-44"><a href="#cb63-44" aria-hidden="true" tabindex="-1"></a>                                  <span class="cf">if</span>(<span class="sc">!</span>between_only) {</span>
<span id="cb63-45"><a href="#cb63-45" aria-hidden="true" tabindex="-1"></a>                                  V_w <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">as.numeric</span>(df_temp<span class="sc">$</span>se)<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb63-46"><a href="#cb63-46" aria-hidden="true" tabindex="-1"></a>                                  <span class="cf">if</span>(strategy <span class="sc">==</span> <span class="st">"MI"</span>) {</span>
<span id="cb63-47"><a href="#cb63-47" aria-hidden="true" tabindex="-1"></a>                                    V_b <span class="ot">&lt;-</span> <span class="fu">var</span>(<span class="fu">as.numeric</span>(df_temp[, <span class="dv">1</span>]))</span>
<span id="cb63-48"><a href="#cb63-48" aria-hidden="true" tabindex="-1"></a>                                    V_t <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(V_w <span class="sc">+</span> V_b <span class="sc">+</span> V_b <span class="sc">/</span> <span class="fu">nrow</span>(df_temp))</span>
<span id="cb63-49"><a href="#cb63-49" aria-hidden="true" tabindex="-1"></a>                                  } <span class="cf">else</span> {</span>
<span id="cb63-50"><a href="#cb63-50" aria-hidden="true" tabindex="-1"></a>                                    V_t <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(V_w)</span>
<span id="cb63-51"><a href="#cb63-51" aria-hidden="true" tabindex="-1"></a>                                  }</span>
<span id="cb63-52"><a href="#cb63-52" aria-hidden="true" tabindex="-1"></a>                                  } <span class="cf">else</span> {</span>
<span id="cb63-53"><a href="#cb63-53" aria-hidden="true" tabindex="-1"></a>                                    V_t <span class="ot">&lt;-</span> <span class="fu">sd</span>(<span class="fu">as.numeric</span>(df_temp[, <span class="dv">1</span>]), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb63-54"><a href="#cb63-54" aria-hidden="true" tabindex="-1"></a>                                  }</span>
<span id="cb63-55"><a href="#cb63-55" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">return</span>(<span class="fu">round</span>(V_t, <span class="at">digits =</span> <span class="dv">3</span>))</span>
<span id="cb63-56"><a href="#cb63-56" aria-hidden="true" tabindex="-1"></a>                                })</span>
<span id="cb63-57"><a href="#cb63-57" aria-hidden="true" tabindex="-1"></a>                       }))</span>
<span id="cb63-58"><a href="#cb63-58" aria-hidden="true" tabindex="-1"></a>  display_true <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Full Sample SE = "</span>, <span class="fu">round</span>(true_se, <span class="at">digits =</span> <span class="dv">3</span>))</span>
<span id="cb63-59"><a href="#cb63-59" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> knitr<span class="sc">::</span><span class="fu">kable</span>(pooled_ses,</span>
<span id="cb63-60"><a href="#cb63-60" aria-hidden="true" tabindex="-1"></a>                         <span class="at">caption =</span> <span class="st">"Standard Errors for Different Strategies under Different Missing-Data-Mechanisms"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-61"><a href="#cb63-61" aria-hidden="true" tabindex="-1"></a>    kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb63-62"><a href="#cb63-62" aria-hidden="true" tabindex="-1"></a>                              <span class="at">position =</span> <span class="st">"center"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-63"><a href="#cb63-63" aria-hidden="true" tabindex="-1"></a>    kableExtra<span class="sc">::</span><span class="fu">footnote</span>(<span class="at">general_title =</span> <span class="st">"Note."</span>,</span>
<span id="cb63-64"><a href="#cb63-64" aria-hidden="true" tabindex="-1"></a>                         <span class="at">general =</span> display_true</span>
<span id="cb63-65"><a href="#cb63-65" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb63-66"><a href="#cb63-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-67"><a href="#cb63-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb63-68"><a href="#cb63-68" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-69"><a href="#cb63-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-70"><a href="#cb63-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-71"><a href="#cb63-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Conduct multiple imputations for all datasets</span></span>
<span id="cb63-72"><a href="#cb63-72" aria-hidden="true" tabindex="-1"></a>list_simulation_mi <span class="ot">&lt;-</span> <span class="fu">lapply</span>(list_simulation,</span>
<span id="cb63-73"><a href="#cb63-73" aria-hidden="true" tabindex="-1"></a>                             <span class="cf">function</span>(mechanism) {</span>
<span id="cb63-74"><a href="#cb63-74" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">lapply</span>(mechanism,</span>
<span id="cb63-75"><a href="#cb63-75" aria-hidden="true" tabindex="-1"></a>                                      <span class="cf">function</span>(data) { </span>
<span id="cb63-76"><a href="#cb63-76" aria-hidden="true" tabindex="-1"></a>                                        data_temp <span class="ot">&lt;-</span> data[, <span class="fu">c</span>(<span class="st">"sex"</span>, <span class="st">"grade"</span>, variable_names)]</span>
<span id="cb63-77"><a href="#cb63-77" aria-hidden="true" tabindex="-1"></a>                                        mice<span class="sc">::</span><span class="fu">mice</span>(data_temp,</span>
<span id="cb63-78"><a href="#cb63-78" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">m =</span> <span class="dv">15</span>,</span>
<span id="cb63-79"><a href="#cb63-79" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">method =</span> <span class="st">"pmm"</span>, </span>
<span id="cb63-80"><a href="#cb63-80" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">maxit =</span> <span class="dv">10</span>,</span>
<span id="cb63-81"><a href="#cb63-81" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">printFlag =</span> <span class="cn">FALSE</span>)</span>
<span id="cb63-82"><a href="#cb63-82" aria-hidden="true" tabindex="-1"></a>                                        })</span>
<span id="cb63-83"><a href="#cb63-83" aria-hidden="true" tabindex="-1"></a>                               })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="descriptive-statistics" class="level3">
<h3 class="anchored" data-anchor-id="descriptive-statistics">Descriptive Statistics</h3>
<p>We estimated bias and standard error (SE) for the mean of the first item. The plot below shows the bias for the estimated mean for the different strategies under the three missing data mechanisms. The plot allows two takeaways. First, the mean for each strategy is substantially lower than the true mean from the full sample under MNAR. This is expected since missing data were generated by deleting high values. Second, pairwise deletion and multiple imputation recover the true mean relatively well under MAR and all strategies recover the true mean well under MCAR. The table below displays the SEs. As expected the SEs were usually slightly higher than the SE of the full sample. However, the SEs of listwise deletion were substantially larger than those of pairwise deletion and multiple imputations. This finding indicates that these two methods are statistically more efficient (i.e., more precise) than listwise deletion.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate statistics for pairwise deletion</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>simulation_descriptives_pairwise <span class="ot">&lt;-</span> <span class="fu">lapply</span>(list_simulation,</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>                                           <span class="cf">function</span>(mechanism) {</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>                                             data_temp <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">sapply</span>(mechanism,</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>                                                                 <span class="cf">function</span>(df_temp) {</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>                                                                   raw_descs <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">describe</span>(df_temp<span class="sc">$</span>x1)[,<span class="fu">c</span>(<span class="st">"mean"</span>, <span class="st">"se"</span>)]</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>                                                                 }))</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>                                             <span class="fu">return</span>(data_temp)</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>                                           }) <span class="sc">%&gt;%</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">do.call</span>(rbind.data.frame, .)</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(simulation_descriptives_pairwise) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"means"</span>, <span class="st">"se"</span>)</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>simulation_descriptives_pairwise<span class="sc">$</span>mechanism <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"MCAR"</span>, <span class="st">"MAR"</span>, <span class="st">"MNAR"</span>), <span class="at">each =</span> <span class="dv">500</span>)</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>simulation_descriptives_pairwise<span class="sc">$</span>strategy <span class="ot">&lt;-</span> <span class="st">"Pairwise"</span></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate statistics for listwise deletion</span></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>simulation_descriptives_listwise <span class="ot">&lt;-</span> <span class="fu">lapply</span>(list_simulation,</span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>                                           <span class="cf">function</span>(mechanism) {</span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>                                              data_temp <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">sapply</span>(mechanism,</span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>                                                                 <span class="cf">function</span>(df_temp) {</span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a>                                                                   data_listwise <span class="ot">&lt;-</span> df_temp[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(df_temp[, variable_names])) <span class="sc">==</span> <span class="dv">0</span>, ]</span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a>                                                                   raw_descs <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">describe</span>(data_listwise<span class="sc">$</span>x1)[,<span class="fu">c</span>(<span class="st">"mean"</span>, <span class="st">"se"</span>)]</span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a>                                                                 }))</span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a>                                             <span class="fu">return</span>(data_temp)</span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a>                                           }) <span class="sc">%&gt;%</span></span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">do.call</span>(rbind.data.frame, .)</span>
<span id="cb64-26"><a href="#cb64-26" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(simulation_descriptives_listwise) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"means"</span>, <span class="st">"se"</span>)</span>
<span id="cb64-27"><a href="#cb64-27" aria-hidden="true" tabindex="-1"></a>simulation_descriptives_listwise<span class="sc">$</span>mechanism <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"MCAR"</span>, <span class="st">"MAR"</span>, <span class="st">"MNAR"</span>), <span class="at">each =</span> <span class="dv">500</span>)</span>
<span id="cb64-28"><a href="#cb64-28" aria-hidden="true" tabindex="-1"></a>simulation_descriptives_listwise<span class="sc">$</span>strategy <span class="ot">&lt;-</span> <span class="st">"Listwise"</span></span>
<span id="cb64-29"><a href="#cb64-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-30"><a href="#cb64-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate statistics for multiple imputations</span></span>
<span id="cb64-31"><a href="#cb64-31" aria-hidden="true" tabindex="-1"></a>simulation_descriptives_mi <span class="ot">&lt;-</span> <span class="fu">lapply</span>(list_simulation_mi,</span>
<span id="cb64-32"><a href="#cb64-32" aria-hidden="true" tabindex="-1"></a>                                           <span class="cf">function</span>(mechanism) {</span>
<span id="cb64-33"><a href="#cb64-33" aria-hidden="true" tabindex="-1"></a>                                             data_temp <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">sapply</span>(mechanism,</span>
<span id="cb64-34"><a href="#cb64-34" aria-hidden="true" tabindex="-1"></a>                                                                 <span class="cf">function</span>(imp_data) {</span>
<span id="cb64-35"><a href="#cb64-35" aria-hidden="true" tabindex="-1"></a>                                                                    means <span class="ot">&lt;-</span> <span class="fu">with</span>(imp_data, <span class="fu">lm</span>(x1 <span class="sc">~</span> <span class="dv">1</span>))</span>
<span id="cb64-36"><a href="#cb64-36" aria-hidden="true" tabindex="-1"></a>                                                                    pooled_mean <span class="ot">&lt;-</span> mice<span class="sc">::</span><span class="fu">pool</span>(means)</span>
<span id="cb64-37"><a href="#cb64-37" aria-hidden="true" tabindex="-1"></a>                                                                    summary_pooled <span class="ot">&lt;-</span> <span class="fu">summary</span>(pooled_mean)</span>
<span id="cb64-38"><a href="#cb64-38" aria-hidden="true" tabindex="-1"></a>                                                                    out <span class="ot">&lt;-</span> <span class="fu">unlist</span>(summary_pooled[, <span class="fu">c</span>(<span class="st">"estimate"</span>, <span class="st">"std.error"</span>)])</span>
<span id="cb64-39"><a href="#cb64-39" aria-hidden="true" tabindex="-1"></a>                                                                    <span class="fu">return</span>(out)</span>
<span id="cb64-40"><a href="#cb64-40" aria-hidden="true" tabindex="-1"></a>                                                                 }))</span>
<span id="cb64-41"><a href="#cb64-41" aria-hidden="true" tabindex="-1"></a>                                             <span class="fu">return</span>(data_temp)</span>
<span id="cb64-42"><a href="#cb64-42" aria-hidden="true" tabindex="-1"></a>                                           }) <span class="sc">%&gt;%</span></span>
<span id="cb64-43"><a href="#cb64-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">do.call</span>(rbind.data.frame, .)</span>
<span id="cb64-44"><a href="#cb64-44" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(simulation_descriptives_mi) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"means"</span>, <span class="st">"se"</span>)</span>
<span id="cb64-45"><a href="#cb64-45" aria-hidden="true" tabindex="-1"></a>simulation_descriptives_mi<span class="sc">$</span>mechanism <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"MCAR"</span>, <span class="st">"MAR"</span>, <span class="st">"MNAR"</span>), <span class="at">each =</span> <span class="dv">500</span>)</span>
<span id="cb64-46"><a href="#cb64-46" aria-hidden="true" tabindex="-1"></a>simulation_descriptives_mi<span class="sc">$</span>strategy <span class="ot">&lt;-</span> <span class="st">"MI"</span></span>
<span id="cb64-47"><a href="#cb64-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-48"><a href="#cb64-48" aria-hidden="true" tabindex="-1"></a><span class="co"># built a list with all simulation results</span></span>
<span id="cb64-49"><a href="#cb64-49" aria-hidden="true" tabindex="-1"></a>simulation_descriptives <span class="ot">&lt;-</span> <span class="fu">rbind</span>(simulation_descriptives_pairwise,</span>
<span id="cb64-50"><a href="#cb64-50" aria-hidden="true" tabindex="-1"></a>                                 simulation_descriptives_listwise,</span>
<span id="cb64-51"><a href="#cb64-51" aria-hidden="true" tabindex="-1"></a>                                 simulation_descriptives_mi)</span>
<span id="cb64-52"><a href="#cb64-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-53"><a href="#cb64-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-54"><a href="#cb64-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plots &amp; table</span></span>
<span id="cb64-55"><a href="#cb64-55" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_bias</span>(simulation_descriptives,</span>
<span id="cb64-56"><a href="#cb64-56" aria-hidden="true" tabindex="-1"></a>          <span class="at">true =</span> <span class="fu">mean</span>(Data<span class="sc">$</span>x1),</span>
<span id="cb64-57"><a href="#cb64-57" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"Bias for the Mean of Item X1"</span>,</span>
<span id="cb64-58"><a href="#cb64-58" aria-hidden="true" tabindex="-1"></a>          <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Pairwise"</span>, <span class="st">"Listwise"</span>, <span class="st">"MI"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_data_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table_se</span>(simulation_descriptives,</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">true_se =</span> <span class="fu">sd</span>(Data<span class="sc">$</span>x1) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">nrow</span>(Data)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<caption>Standard Errors for Different Strategies under Different Missing-Data-Mechanisms</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">MCAR</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">MAR</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">MNAR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Pairwise</td>
<td style="text-align: right;">0.073</td>
<td style="text-align: right;">0.073</td>
<td style="text-align: right;">0.061</td>
</tr>
<tr class="even">
<td style="text-align: left;">Listwise</td>
<td style="text-align: right;">0.141</td>
<td style="text-align: right;">0.090</td>
<td style="text-align: right;">0.092</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MI</td>
<td style="text-align: right;">0.076</td>
<td style="text-align: right;">0.079</td>
<td style="text-align: right;">0.069</td>
</tr>
</tbody><tfoot>
<tr class="even">
<td style="text-align: left; padding: 0;"><span style="font-style: italic;">Note.</span></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0;"><sup></sup> Full Sample SE = 0.067</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tfoot>

</table>


</div>
</div>
</section>
<section id="model-fit" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="model-fit">Model Fit</h3>
<p>We estimated bias and standard error (SE) for the CFI of the three-factor model<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>. The plot and the table below display bias and SEs for different strategies under different missing data mechanisms. The plot shows that the CFI of the full sample is recovered well by all strategies under MCAR Under MAR, multiple imputations recover the CFI well. Under MNAR, no strategy can recover the CFI well.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>According to the study of <span class="citation" data-cites="lee2021">Lee and Shi (<a href="#ref-lee2021" role="doc-biblioref">2021</a>)</span>, FIML tends to overestimate the CFI, whereas multiple imputation tends to underestimate the RMSEA. Therefore, they recommend relying on the CFI when using multiple imputation and on the RMSEA when using FIML. When the respective fit indices (CFI or RMSEA) are used, both strategies provide Monte Carlo–unbiased estimates of model fit.</p>
</div></div><div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate cfas using fiml</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>simulation_cfas_fiml <span class="ot">&lt;-</span> <span class="fu">lapply</span>(list_simulation,</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>                               <span class="cf">function</span>(mechanism) {</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>                                 cfas <span class="ot">&lt;-</span> <span class="fu">lapply</span>(mechanism,</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>                                                lavaan<span class="sc">::</span>cfa,</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">model =</span> three_fator_model,</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">std.lv =</span> <span class="cn">TRUE</span>, </span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">estimator =</span> <span class="st">"ml"</span>,</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">missing =</span> <span class="st">"FIML"</span>)</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">return</span>(cfas)</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>                               })</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract CFI</span></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>simulation_cfi_fiml_raw <span class="ot">&lt;-</span> <span class="fu">lapply</span>(simulation_cfas_fiml,</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">function</span>(mechanism) {</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>                                  out <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(<span class="fu">sapply</span>(mechanism,</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>                                                                lavaan<span class="sc">::</span>fitmeasures,</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>                                                                <span class="fu">c</span>(<span class="st">"cfi"</span>))))</span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">return</span>(out)</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>                                }) </span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>simulation_cfi_fiml <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">CFI =</span> <span class="fu">unlist</span>(simulation_cfi_fiml_raw),</span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">mechanism =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"MCAR"</span>, <span class="st">"MAR"</span>, <span class="st">"MNAR"</span>), <span class="at">each =</span> <span class="dv">500</span>),</span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">strategy =</span> <span class="st">"FIML"</span>)</span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate cfa using listwise deletion</span></span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a>simulation_cfas_listwise <span class="ot">&lt;-</span> <span class="fu">lapply</span>(list_simulation,</span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a>                                   <span class="cf">function</span>(mechanism) {</span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a>                                     cfas <span class="ot">&lt;-</span> <span class="fu">lapply</span>(mechanism,</span>
<span id="cb66-30"><a href="#cb66-30" aria-hidden="true" tabindex="-1"></a>                                                    <span class="cf">function</span>(data) {</span>
<span id="cb66-31"><a href="#cb66-31" aria-hidden="true" tabindex="-1"></a>                                                      data_temp <span class="ot">&lt;-</span> data[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(data[, variable_names])) <span class="sc">==</span> <span class="dv">0</span>, ]</span>
<span id="cb66-32"><a href="#cb66-32" aria-hidden="true" tabindex="-1"></a>                                                      out <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">cfa</span>(<span class="at">model =</span> three_fator_model,</span>
<span id="cb66-33"><a href="#cb66-33" aria-hidden="true" tabindex="-1"></a>                                                                         <span class="at">data =</span> data_temp,</span>
<span id="cb66-34"><a href="#cb66-34" aria-hidden="true" tabindex="-1"></a>                                                                         <span class="at">std.lv =</span> <span class="cn">TRUE</span>, </span>
<span id="cb66-35"><a href="#cb66-35" aria-hidden="true" tabindex="-1"></a>                                                                         <span class="at">estimator =</span> <span class="st">"ml"</span>)</span>
<span id="cb66-36"><a href="#cb66-36" aria-hidden="true" tabindex="-1"></a>                                                      <span class="fu">return</span>(out)</span>
<span id="cb66-37"><a href="#cb66-37" aria-hidden="true" tabindex="-1"></a>                                                    })</span>
<span id="cb66-38"><a href="#cb66-38" aria-hidden="true" tabindex="-1"></a>                                                    </span>
<span id="cb66-39"><a href="#cb66-39" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">return</span>(cfas)</span>
<span id="cb66-40"><a href="#cb66-40" aria-hidden="true" tabindex="-1"></a>                                     }) </span>
<span id="cb66-41"><a href="#cb66-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract CFI</span></span>
<span id="cb66-42"><a href="#cb66-42" aria-hidden="true" tabindex="-1"></a>simulation_cfi_listwise_raw <span class="ot">&lt;-</span> <span class="fu">lapply</span>(simulation_cfas_listwise,</span>
<span id="cb66-43"><a href="#cb66-43" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">function</span>(mechanism) {</span>
<span id="cb66-44"><a href="#cb66-44" aria-hidden="true" tabindex="-1"></a>                                  mechanism <span class="ot">&lt;-</span> mechanism[<span class="fu">sapply</span>(mechanism, <span class="cf">function</span>(model) {model<span class="sc">@</span>Fit<span class="sc">@</span>converged})]</span>
<span id="cb66-45"><a href="#cb66-45" aria-hidden="true" tabindex="-1"></a>                                  out <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">sapply</span>(mechanism,</span>
<span id="cb66-46"><a href="#cb66-46" aria-hidden="true" tabindex="-1"></a>                                                  lavaan<span class="sc">::</span>fitmeasures,</span>
<span id="cb66-47"><a href="#cb66-47" aria-hidden="true" tabindex="-1"></a>                                                  <span class="fu">c</span>(<span class="st">"cfi"</span>)))</span>
<span id="cb66-48"><a href="#cb66-48" aria-hidden="true" tabindex="-1"></a>                                  <span class="cf">if</span>(<span class="fu">length</span>(out) <span class="sc">&lt;</span> <span class="dv">500</span>) {</span>
<span id="cb66-49"><a href="#cb66-49" aria-hidden="true" tabindex="-1"></a>                                    out <span class="ot">&lt;-</span> <span class="fu">c</span>(out,</span>
<span id="cb66-50"><a href="#cb66-50" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="at">times =</span> <span class="dv">500</span> <span class="sc">-</span> <span class="fu">length</span>(out)))</span>
<span id="cb66-51"><a href="#cb66-51" aria-hidden="true" tabindex="-1"></a>                                  }</span>
<span id="cb66-52"><a href="#cb66-52" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">return</span>(out)</span>
<span id="cb66-53"><a href="#cb66-53" aria-hidden="true" tabindex="-1"></a>                                })</span>
<span id="cb66-54"><a href="#cb66-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-55"><a href="#cb66-55" aria-hidden="true" tabindex="-1"></a>simulation_cfi_listwise <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">CFI =</span> <span class="fu">unlist</span>(simulation_cfi_listwise_raw),</span>
<span id="cb66-56"><a href="#cb66-56" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">mechanism =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"MCAR"</span>, <span class="st">"MAR"</span>, <span class="st">"MNAR"</span>), <span class="at">each =</span> <span class="dv">500</span>),</span>
<span id="cb66-57"><a href="#cb66-57" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">strategy =</span> <span class="st">"Listwise"</span>)</span>
<span id="cb66-58"><a href="#cb66-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-59"><a href="#cb66-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate cfa using multiple imputations</span></span>
<span id="cb66-60"><a href="#cb66-60" aria-hidden="true" tabindex="-1"></a>simulation_cfas_mi <span class="ot">&lt;-</span> <span class="fu">lapply</span>(list_simulation_mi,</span>
<span id="cb66-61"><a href="#cb66-61" aria-hidden="true" tabindex="-1"></a>                               <span class="cf">function</span>(mechanism) {</span>
<span id="cb66-62"><a href="#cb66-62" aria-hidden="true" tabindex="-1"></a>                                 cfas <span class="ot">&lt;-</span> <span class="fu">lapply</span>(mechanism,</span>
<span id="cb66-63"><a href="#cb66-63" aria-hidden="true" tabindex="-1"></a>                                                lavaan.mi<span class="sc">::</span>cfa.mi,</span>
<span id="cb66-64"><a href="#cb66-64" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">model =</span> three_fator_model,</span>
<span id="cb66-65"><a href="#cb66-65" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">std.lv =</span> <span class="cn">TRUE</span>, </span>
<span id="cb66-66"><a href="#cb66-66" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">estimator =</span> <span class="st">"ml"</span>)</span>
<span id="cb66-67"><a href="#cb66-67" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">return</span>(cfas)</span>
<span id="cb66-68"><a href="#cb66-68" aria-hidden="true" tabindex="-1"></a>                               })</span>
<span id="cb66-69"><a href="#cb66-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-70"><a href="#cb66-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-71"><a href="#cb66-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract CFI</span></span>
<span id="cb66-72"><a href="#cb66-72" aria-hidden="true" tabindex="-1"></a>simulation_cfi_mi_raw <span class="ot">&lt;-</span> <span class="fu">lapply</span>(simulation_cfas_mi,</span>
<span id="cb66-73"><a href="#cb66-73" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">function</span>(mechanism) {</span>
<span id="cb66-74"><a href="#cb66-74" aria-hidden="true" tabindex="-1"></a>                                  out <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">sapply</span>(mechanism,</span>
<span id="cb66-75"><a href="#cb66-75" aria-hidden="true" tabindex="-1"></a>                                                lavaan.mi<span class="sc">::</span>fitmeasures,</span>
<span id="cb66-76"><a href="#cb66-76" aria-hidden="true" tabindex="-1"></a>                                                <span class="fu">c</span>(<span class="st">"cfi"</span>)))</span>
<span id="cb66-77"><a href="#cb66-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-78"><a href="#cb66-78" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">return</span>(out)</span>
<span id="cb66-79"><a href="#cb66-79" aria-hidden="true" tabindex="-1"></a>                                })</span>
<span id="cb66-80"><a href="#cb66-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-81"><a href="#cb66-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-82"><a href="#cb66-82" aria-hidden="true" tabindex="-1"></a>simulation_cfi_mi <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">CFI =</span> <span class="fu">unlist</span>(simulation_cfi_mi_raw),</span>
<span id="cb66-83"><a href="#cb66-83" aria-hidden="true" tabindex="-1"></a>                                <span class="at">mechanism =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"MCAR"</span>, <span class="st">"MAR"</span>, <span class="st">"MNAR"</span>), <span class="at">each =</span> <span class="dv">500</span>),</span>
<span id="cb66-84"><a href="#cb66-84" aria-hidden="true" tabindex="-1"></a>                                <span class="at">strategy =</span> <span class="st">"MI"</span>)</span>
<span id="cb66-85"><a href="#cb66-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-86"><a href="#cb66-86" aria-hidden="true" tabindex="-1"></a><span class="co"># built a list with all simulation results</span></span>
<span id="cb66-87"><a href="#cb66-87" aria-hidden="true" tabindex="-1"></a>simulation_cfi <span class="ot">&lt;-</span> <span class="fu">rbind</span>(simulation_cfi_fiml,</span>
<span id="cb66-88"><a href="#cb66-88" aria-hidden="true" tabindex="-1"></a>                         simulation_cfi_listwise,</span>
<span id="cb66-89"><a href="#cb66-89" aria-hidden="true" tabindex="-1"></a>                         simulation_cfi_mi)</span>
<span id="cb66-90"><a href="#cb66-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-91"><a href="#cb66-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-92"><a href="#cb66-92" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate SE for cfi omega using bootstrapping</span></span>
<span id="cb66-93"><a href="#cb66-93" aria-hidden="true" tabindex="-1"></a>bootstrap_cfas <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_dfr</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">500</span>),</span>
<span id="cb66-94"><a href="#cb66-94" aria-hidden="true" tabindex="-1"></a>                                 <span class="cf">function</span>(index) {</span>
<span id="cb66-95"><a href="#cb66-95" aria-hidden="true" tabindex="-1"></a>                                   Data_temp <span class="ot">&lt;-</span> Data[<span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(Data)),</span>
<span id="cb66-96"><a href="#cb66-96" aria-hidden="true" tabindex="-1"></a>                                                            <span class="fu">nrow</span>(Data),</span>
<span id="cb66-97"><a href="#cb66-97" aria-hidden="true" tabindex="-1"></a>                                                            <span class="at">replace =</span> <span class="cn">TRUE</span>), ]</span>
<span id="cb66-98"><a href="#cb66-98" aria-hidden="true" tabindex="-1"></a>                                   cfa_temp <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">cfa</span>(three_fator_model,</span>
<span id="cb66-99"><a href="#cb66-99" aria-hidden="true" tabindex="-1"></a>                                                           <span class="at">data =</span> Data_temp, </span>
<span id="cb66-100"><a href="#cb66-100" aria-hidden="true" tabindex="-1"></a>                                                           <span class="at">estimator =</span> <span class="st">"ml"</span>,</span>
<span id="cb66-101"><a href="#cb66-101" aria-hidden="true" tabindex="-1"></a>                                                           <span class="at">std.lv =</span> <span class="cn">TRUE</span>)</span>
<span id="cb66-102"><a href="#cb66-102" aria-hidden="true" tabindex="-1"></a>                                   omega_temp <span class="ot">&lt;-</span> semTools<span class="sc">::</span><span class="fu">compRelSEM</span>(cfa_temp)[<span class="dv">2</span>]</span>
<span id="cb66-103"><a href="#cb66-103" aria-hidden="true" tabindex="-1"></a>                                   cfi_temp <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">fitmeasures</span>(cfa_temp, <span class="st">"cfi"</span>)</span>
<span id="cb66-104"><a href="#cb66-104" aria-hidden="true" tabindex="-1"></a>                                   out <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">omega =</span> omega_temp,</span>
<span id="cb66-105"><a href="#cb66-105" aria-hidden="true" tabindex="-1"></a>                                                     <span class="at">cfi =</span> cfi_temp)</span>
<span id="cb66-106"><a href="#cb66-106" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">return</span>(out)</span>
<span id="cb66-107"><a href="#cb66-107" aria-hidden="true" tabindex="-1"></a>                                   })</span>
<span id="cb66-108"><a href="#cb66-108" aria-hidden="true" tabindex="-1"></a>se_cfi <span class="ot">&lt;-</span> <span class="fu">sd</span>(bootstrap_cfas<span class="sc">$</span>cfi, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb66-109"><a href="#cb66-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-110"><a href="#cb66-110" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plots &amp; table</span></span>
<span id="cb66-111"><a href="#cb66-111" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_bias</span>(simulation_cfi,</span>
<span id="cb66-112"><a href="#cb66-112" aria-hidden="true" tabindex="-1"></a>          <span class="at">true =</span> lavaan<span class="sc">::</span><span class="fu">fitmeasures</span>(cfa_full_data, <span class="st">"cfi"</span>),</span>
<span id="cb66-113"><a href="#cb66-113" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"Bias for the CFI"</span>,</span>
<span id="cb66-114"><a href="#cb66-114" aria-hidden="true" tabindex="-1"></a>          <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"FIML"</span>, <span class="st">"Listwise"</span>, <span class="st">"MI"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_data_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table_se</span>(simulation_cfi,</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">true_se =</span> se_cfi,</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">between_only =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<caption>Standard Errors for Different Strategies under Different Missing-Data-Mechanisms</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">MCAR</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">MAR</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">MNAR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">FIML</td>
<td style="text-align: right;">0.013</td>
<td style="text-align: right;">0.008</td>
<td style="text-align: right;">0.006</td>
</tr>
<tr class="even">
<td style="text-align: left;">Listwise</td>
<td style="text-align: right;">0.041</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">0.023</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MI</td>
<td style="text-align: right;">0.015</td>
<td style="text-align: right;">0.010</td>
<td style="text-align: right;">0.008</td>
</tr>
</tbody><tfoot>
<tr class="even">
<td style="text-align: left; padding: 0;"><span style="font-style: italic;">Note.</span></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0;"><sup></sup> Full Sample SE = 0.02</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tfoot>

</table>


</div>
</div>
</section>
<section id="reliability" class="level3">
<h3 class="anchored" data-anchor-id="reliability">Reliability</h3>
<p>We estimate bias and standard error (SE) for McDonald’s omega<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>. We focus on the omega of the subscale <em>textual</em>. All strategies recover the reliability of the full sample accurately under MCAR and MAR, but not under MNAR. As before, FIML and multiple imputation are statistically more efficient than listwise deletion.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate statistics for FIML</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>simulation_reliability_fiml <span class="ot">&lt;-</span> <span class="fu">lapply</span>(simulation_cfas_fiml,</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>                                      <span class="cf">function</span>(mechanism) {</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>                                        all_omegas <span class="ot">&lt;-</span> <span class="fu">sapply</span>(mechanism,</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>                                                             semTools<span class="sc">::</span>compRelSEM)</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>                                        omega_textual <span class="ot">&lt;-</span> all_omegas[<span class="dv">2</span>, ]</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>                                        <span class="fu">return</span>(omega_textual)</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>                                        }) <span class="sc">%&gt;%</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unlist</span>()</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>simulation_reliability_fiml_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">omega =</span> simulation_reliability_fiml,</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">mechanism =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"MCAR"</span>, <span class="st">"MAR"</span>, <span class="st">"MNAR"</span>), <span class="at">each =</span> <span class="dv">500</span>),</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">strategy =</span> <span class="st">"FIML"</span>)</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate statistics for listwise deletion</span></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>simulation_reliability_listwise <span class="ot">&lt;-</span> <span class="fu">lapply</span>(simulation_cfas_listwise,</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>                                          <span class="cf">function</span>(mechanism) {</span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>                                            all_omegas <span class="ot">&lt;-</span> <span class="fu">sapply</span>(mechanism,</span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>                                                                 semTools<span class="sc">::</span>compRelSEM)</span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>                                            omega_textual <span class="ot">&lt;-</span> all_omegas[<span class="dv">2</span>, ]</span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">return</span>(omega_textual)</span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>                                        }) <span class="sc">%&gt;%</span></span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unlist</span>()</span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a>simulation_reliability_listwise_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">omega =</span> simulation_reliability_listwise,</span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a>                                                      <span class="at">mechanism =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"MCAR"</span>, <span class="st">"MAR"</span>, <span class="st">"MNAR"</span>), <span class="at">each =</span> <span class="dv">500</span>),</span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a>                                                      <span class="at">strategy =</span> <span class="st">"Listwise"</span>)</span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate statistics for multiple imputations</span></span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a>simulation_reliability_mi <span class="ot">&lt;-</span> <span class="fu">lapply</span>(simulation_cfas_mi,</span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a>                                      <span class="cf">function</span>(mechanism) {</span>
<span id="cb68-30"><a href="#cb68-30" aria-hidden="true" tabindex="-1"></a>                                        all_omegas <span class="ot">&lt;-</span> <span class="fu">sapply</span>(mechanism,</span>
<span id="cb68-31"><a href="#cb68-31" aria-hidden="true" tabindex="-1"></a>                                                             semTools<span class="sc">::</span>compRelSEM)</span>
<span id="cb68-32"><a href="#cb68-32" aria-hidden="true" tabindex="-1"></a>                                        omega_textual <span class="ot">&lt;-</span> all_omegas[<span class="dv">2</span>, ]</span>
<span id="cb68-33"><a href="#cb68-33" aria-hidden="true" tabindex="-1"></a>                                        <span class="fu">return</span>(omega_textual)</span>
<span id="cb68-34"><a href="#cb68-34" aria-hidden="true" tabindex="-1"></a>                                        }) <span class="sc">%&gt;%</span></span>
<span id="cb68-35"><a href="#cb68-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unlist</span>()</span>
<span id="cb68-36"><a href="#cb68-36" aria-hidden="true" tabindex="-1"></a>simulation_reliability_mi_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">omega =</span> simulation_reliability_mi,</span>
<span id="cb68-37"><a href="#cb68-37" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">mechanism =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"MCAR"</span>, <span class="st">"MAR"</span>, <span class="st">"MNAR"</span>), <span class="at">each =</span> <span class="dv">500</span>),</span>
<span id="cb68-38"><a href="#cb68-38" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">strategy =</span> <span class="st">"MI"</span>)</span>
<span id="cb68-39"><a href="#cb68-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-40"><a href="#cb68-40" aria-hidden="true" tabindex="-1"></a><span class="co"># built a list with all simulation results</span></span>
<span id="cb68-41"><a href="#cb68-41" aria-hidden="true" tabindex="-1"></a>simulation_reliability <span class="ot">&lt;-</span> <span class="fu">rbind</span>(simulation_reliability_fiml_results,</span>
<span id="cb68-42"><a href="#cb68-42" aria-hidden="true" tabindex="-1"></a>                               simulation_reliability_listwise_results,</span>
<span id="cb68-43"><a href="#cb68-43" aria-hidden="true" tabindex="-1"></a>                               simulation_reliability_mi_results)</span>
<span id="cb68-44"><a href="#cb68-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-45"><a href="#cb68-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract SE</span></span>
<span id="cb68-46"><a href="#cb68-46" aria-hidden="true" tabindex="-1"></a>se_omega <span class="ot">&lt;-</span> <span class="fu">sd</span>(bootstrap_cfas<span class="sc">$</span>omega)</span>
<span id="cb68-47"><a href="#cb68-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-48"><a href="#cb68-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plots &amp; table</span></span>
<span id="cb68-49"><a href="#cb68-49" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_bias</span>(simulation_reliability,</span>
<span id="cb68-50"><a href="#cb68-50" aria-hidden="true" tabindex="-1"></a>          <span class="at">true =</span> semTools<span class="sc">::</span><span class="fu">compRelSEM</span>(cfa_full_data)[<span class="dv">2</span>],</span>
<span id="cb68-51"><a href="#cb68-51" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"Bias for the Reliability"</span>,</span>
<span id="cb68-52"><a href="#cb68-52" aria-hidden="true" tabindex="-1"></a>          <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"FIML"</span>, <span class="st">"Listwise"</span>, <span class="st">"MI"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_data_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table_se</span>(simulation_reliability,</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">true_se =</span> se_omega,</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">between_only =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<caption>Standard Errors for Different Strategies under Different Missing-Data-Mechanisms</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">MCAR</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">MAR</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">MNAR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">FIML</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.004</td>
</tr>
<tr class="even">
<td style="text-align: left;">Listwise</td>
<td style="text-align: right;">0.021</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.006</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MI</td>
<td style="text-align: right;">0.005</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.004</td>
</tr>
</tbody><tfoot>
<tr class="even">
<td style="text-align: left; padding: 0;"><span style="font-style: italic;">Note.</span></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0;"><sup></sup> Full Sample SE = 0.011</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tfoot>

</table>


</div>
</div>
</section>
<section id="factor-loadings" class="level3">
<h3 class="anchored" data-anchor-id="factor-loadings">Factor Loadings</h3>
<p>We estimate bias and empirical SE for the factor loading of the first item. Again, we observe a similar pattern. All strategies recover the true factor loading well under MCAR and MAR but not under MNAR, and FIML and multiple imputation are statistically more efficient than listwise deletion.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="missing_data_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<caption>Standard Errors for Different Strategies under Different Missing-Data-Mechanisms</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">MCAR</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">MAR</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">MNAR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">FIML</td>
<td style="text-align: right;">0.095</td>
<td style="text-align: right;">0.088</td>
<td style="text-align: right;">0.113</td>
</tr>
<tr class="even">
<td style="text-align: left;">Listwise</td>
<td style="text-align: right;">0.334</td>
<td style="text-align: right;">0.102</td>
<td style="text-align: right;">0.535</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MI</td>
<td style="text-align: right;">0.111</td>
<td style="text-align: right;">0.099</td>
<td style="text-align: right;">0.121</td>
</tr>
</tbody><tfoot>
<tr class="even">
<td style="text-align: left; padding: 0;"><span style="font-style: italic;">Note.</span></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0;"><sup></sup> Full Sample SE = 0.081</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tfoot>

</table>


</div>
</div>
</section>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>In summary, in our small Monte-Carlo simulation, especially multiple imputation and FIML provided Monte-Carlo unbiased and efficient estimates in psychometric analyses under MCAR and MAR scenarios. For multiple imputations, it is essential to include all relevant variables in the imputation model - otherwise, bias may be introduced. Listwise deletion also yields unbiased estimates under MCAR (and under specific circumstances MAR) but is less efficient. In MNAR scenarios, there is little that can be done to fully account for the missingness. Therefore, FIML and multiple imputation are the preferred strategies for estimating psychometric statistics. It is also crucial that the data are not MNAR, as this severely limits the accuracy of psychometric estimates.</p>
</section>
<section id="conclusion-and-recommendations" class="level2">
<h2 class="anchored" data-anchor-id="conclusion-and-recommendations">Conclusion and recommendations</h2>
<p>In this tutorial, we discussed different mechanisms that can generate missing data and strategies for dealing with them. We showed the consequences of ignoring missing data and explained that, depending on the mechanism driving its presence, you might be able to ameliorate its negative impact, either in terms of bias or loss of precision.</p>
<p>As there are no definitive tests to identify the missing data mechanism (with the exception of tests for data not being MCAR), you should critically reflect on the theoretical process that may have caused the missingness.</p>
<p>If the data are MCAR, you do not need to worry about bias, though the loss of precision may still be an issue. If the data are MAR, both precision and bias can be problematic. In this case, we recommend using multiple imputation or FIML by default. Data that are MNAR are the most difficult to handle. There are no easy solutions, and the available methods typically require a higher level of statistical modeling proficiency. We did not cover these techniques here, but several approaches are available <span class="citation" data-cites="daniels2008 enders2022">(see, e.g., <a href="#ref-daniels2008" role="doc-biblioref">Daniels and Hogan 2008</a>, Ch. 9; <a href="#ref-enders2022" role="doc-biblioref">Enders 2022</a>, Ch. 9)</span> that you may wish to explore if you encounter this situation.</p>

</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-axenfeld2022" class="csl-entry" role="listitem">
Axenfeld, Julian B, Christian Bruch, and Christof Wolf. 2022. <span>“General-Purpose Imputation of Planned Missing Data in Social Surveys: Different Strategies and Their Effect on Correlations.”</span> <em>Statistic Surveys</em> 16: 182–209. <a href="https://doi.org/10.1214/22-SS137">https://doi.org/10.1214/22-SS137</a>.
</div>
<div id="ref-bartlett2020" class="csl-entry" role="listitem">
Bartlett, Jonathan W, and Rachael A Hughes. 2020. <span>“Bootstrap Inference for Multiple Imputation Under Uncongeniality and Misspecification.”</span> <em>Statistical Methods in Medical Research</em> 29 (12): 3533–46. <a href="https://doi.org/10.1177/0962280220932189">https://doi.org/10.1177/0962280220932189</a>.
</div>
<div id="ref-vanbuuren2018" class="csl-entry" role="listitem">
Buuren, Stef van. 2018. <em>Flexible Imputation of Missing Data</em>. 2nd ed. New York: Chapman; Hall/CRC.
</div>
<div id="ref-Chen.2020" class="csl-entry" role="listitem">
Chen, Lihan, Victoria Savalei, and Mijke Rhemtulla. 2020. <span>“Two-Stage Maximum Likelihood Approach for Item-Level Missing Data in Regression.”</span> <em>Behavior Research Methods</em> 52 (6): 2306–23. <a href="https://doi.org/10.3758/s13428-020-01355-x">https://doi.org/10.3758/s13428-020-01355-x</a>.
</div>
<div id="ref-daniels2008" class="csl-entry" role="listitem">
Daniels, Michael J, and Joseph W Hogan. 2008. <em>Missing Data in Longitudinal Studies: Strategies for Bayesian Modeling and Sensitivity Analysis</em>. chapman; hall/CRC. <a href="https://doi.org/10.1201/9781420011180">https://doi.org/10.1201/9781420011180</a>.
</div>
<div id="ref-enders2022" class="csl-entry" role="listitem">
Enders, Craig K. 2022. <em>Applied Missing Data Analysis</em>. Guilford Publications.
</div>
<div id="ref-koller2009" class="csl-entry" role="listitem">
Koller-Meinfelder, Florian. 2009. <span>“Analysis of Incomplete Survey Data: Multiple Imputation via Bayesian Bootstrap Predictive Mean Matching.”</span> PhD thesis, Otto-Friedrich-Universit<span>ä</span>t Bamberg, Fakult<span>ä</span>t Sozial-und&nbsp;….
</div>
<div id="ref-lee2021" class="csl-entry" role="listitem">
Lee, Taehun, and Dexin Shi. 2021. <span>“A Comparison of Full Information Maximum Likelihood and Multiple Imputation in Structural Equation Modeling with Missing Data.”</span> <em>Psychological Methods</em> 26 (4): 466. <a href="https://doi.org/10.1037/met0000381">https://doi.org/10.1037/met0000381</a>.
</div>
<div id="ref-little1986" class="csl-entry" role="listitem">
Little, Roderick J. A. 1986. <span>“Missing Data in Census Bureau Surveys.”</span> In <em>Proceedings of the Second Annual Census Bureau Research Conference</em>. Washington, DC: U.S. Department of Commerce, Bureau of the Census.
</div>
<div id="ref-mazza2015" class="csl-entry" role="listitem">
Mazza, Gina L, Craig K Enders, and Linda S Ruehlman. 2015. <span>“Addressing Item-Level Missing Data: A Comparison of Proration and Full Information Maximum Likelihood Estimation.”</span> <em>Multivariate Behavioral Research</em> 50 (5): 504–19. <a href="https://doi.org/10.1080/00273171.2015.1068157">https://doi.org/10.1080/00273171.2015.1068157</a>.
</div>
<div id="ref-meng1994" class="csl-entry" role="listitem">
Meng, Xiao-Li. 1994. <span>“Multiple-Imputation Inferences with Uncongenial Sources of Input.”</span> <em>Statistical Science</em>, 538–58.
</div>
<div id="ref-morris.2019" class="csl-entry" role="listitem">
Morris, Tim P, Ian R White, and Michael J Crowther. 2019. <span>“Using Simulation Studies to Evaluate Statistical Methods.”</span> <em>Statistics in Medicine</em> 38 (11): 2074–2102. <a href="https://doi.org/10.1002/sim.8086">https://doi.org/10.1002/sim.8086</a>.
</div>
<div id="ref-Murray.2018" class="csl-entry" role="listitem">
Murray, Jared S. 2018. <span>“Multiple Imputation: A Review of Practical and Theoretical Findings.”</span> <em>Statistical Science</em> 33 (2). <a href="https://doi.org/10.1214/18-STS644">https://doi.org/10.1214/18-STS644</a>.
</div>
<div id="ref-oberman2025" class="csl-entry" role="listitem">
Oberman, Hanne. 2025. <em>Ggmice: Visualizations for ’Mice’ with ’Ggplot2’</em>. <a href="https://doi.org/10.32614/CRAN.package.ggmice">https://doi.org/10.32614/CRAN.package.ggmice</a>.
</div>
<div id="ref-Raykov.2011" class="csl-entry" role="listitem">
Raykov, Tenko. 2011. <span>“On Testability of Missing Data Mechanisms in Incomplete Data Sets.”</span> <em>Structural Equation Modeling: A Multidisciplinary Journal</em> 18 (3): 419–29. <a href="https://doi.org/10.1080/10705511.2011.582396">https://doi.org/10.1080/10705511.2011.582396</a>.
</div>
<div id="ref-rosseel2025" class="csl-entry" role="listitem">
Rosseel, Yves, Terrence D. Jorgensen, and Luc De Wilde. 2025. <em><span class="nocase">lavaan</span>: Latent Variable Analysis</em>. <a href="https://doi.org/10.32614/CRAN.package.lavaan">https://doi.org/10.32614/CRAN.package.lavaan</a>.
</div>
<div id="ref-Rubin.1987" class="csl-entry" role="listitem">
Rubin, D. B. 1987. <em>Multiple Imputation for Nonresponse in Surveys.</em> <span>John Wiley <span>&amp;</span> Sons</span>.
</div>
<div id="ref-rubin1986" class="csl-entry" role="listitem">
Rubin, Donald B. 1986. <span>“Statistical Matching Using File Concatenation with Adjusted Weights and Multiple Imputation.”</span> <em>Journal of Business &amp; Economic Statistics</em> 4: 87–94. <a href="https://doi.org/10.1080/07350015.1986.10509497">https://doi.org/10.1080/07350015.1986.10509497</a>.
</div>
<div id="ref-Thoemmes.2015" class="csl-entry" role="listitem">
Thoemmes, Felix, and Karthika Mohan. 2015. <span>“Graphical Representation of Missing Data Problems.”</span> <em>Structural Equation Modeling: A Multidisciplinary Journal</em> 22 (4): 631–42. <a href="https://doi.org/10.1080/10705511.2014.937378">https://doi.org/10.1080/10705511.2014.937378</a>.
</div>
<div id="ref-vanBuuren.2010" class="csl-entry" role="listitem">
van Buuren, Stef. 2010. <span>“Item Imputation Without Specifying Scale Structure.”</span> <em>Methodology</em> 6 (1): 31–36. <a href="https://doi.org/10.1027/1614-2241/a000004">https://doi.org/10.1027/1614-2241/a000004</a>.
</div>
<div id="ref-vanbuuren2011" class="csl-entry" role="listitem">
van Buuren, Stef, and Karin Groothuis-Oudshoorn. 2011. <span>“<span class="nocase">mice</span>: Multivariate Imputation by Chained Equations in r.”</span> <em>Journal of Statistical Software</em> 45 (3): 1–67. <a href="https://doi.org/10.18637/jss.v045.i03">https://doi.org/10.18637/jss.v045.i03</a>.
</div>
<div id="ref-White.2011" class="csl-entry" role="listitem">
White, Ian R., Patrick Royston, and Angela M. Wood. 2011. <span>“Multiple Imputation Using Chained Equations: Issues and Guidance for Practice.”</span> <em>Statistics in Medicine</em> 30 (4): 377–99. <a href="https://doi.org/10.1002/sim.4067">https://doi.org/10.1002/sim.4067</a>.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>for an overview on how to implement pmm for unordered categorical variables, see <span class="citation" data-cites="koller2009">Koller-Meinfelder (<a href="#ref-koller2009" role="doc-biblioref">2009</a>)</span><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Instead of the displayed formula, bootstraping can be used to estimate the within-imputation variance <span class="citation" data-cites="bartlett2020">(<a href="#ref-bartlett2020" role="doc-biblioref">Bartlett and Hughes 2020</a>)</span><a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Because we did not use bootstrapping to estimate the SEs for each sample-based CFI, the SEs simply represent the variance across the sample-based CFIs. However, the samples are not independent, as they are all drawn from the same relatively small population — the full sample. Therefore, the SEs are likely underestimated.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Because we did not use bootstrapping to estimate the SEs for each sample-based reliability, the SEs simply represent the variance across the sample-based reliabilities. However, the samples are not independent, as they are all drawn from the same relatively small population—the full sample. Therefore, the SEs are likely underestimated.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0</a></div></div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@misc{urban2025,
  author = {Urban, Julian and Koc, Piotr and Greer, Zoe and Feldmann,
    Franziska},
  publisher = {GESIS – Leibniz Institute for the Social Sciences},
  title = {Missing {Data} in {Scale} {Validation}},
  date = {2025},
  url = {https://zis.gesis.org/infotexte/GuidelineMaterials.html},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-urban2025" class="csl-entry quarto-appendix-citeas" role="listitem">
Urban, Julian, Piotr Koc, Zoe Greer, and Franziska Feldmann. 2025.
<span>“Missing Data in Scale Validation .”</span> <em>ZIS
R-Tutorials</em>. GESIS – Leibniz Institute for the Social Sciences. <a href="https://zis.gesis.org/infotexte/GuidelineMaterials.html">https://zis.gesis.org/infotexte/GuidelineMaterials.html</a>.
</div></div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>